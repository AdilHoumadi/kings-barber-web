import{c as $,u as _,j as e,r as g,d as ve,a as S,G as ke,P as J,C as We,X as oe,b as tt}from"./index-DITZVfEb.js";import{L as st}from"./LanguageSwitcher-YEBje_AH.js";import{C as K}from"./calendar-4_eB3IqT.js";import{t as ye,b as Ue,c as at,m as Ee,d as ze,g as ue,h as q,i as X,j as rt,r as ee,f as M,a as Re,D as Ke,P as nt,C as lt,L as it}from"./style-CbhFPYFe.js";import{C as O}from"./clock-YkV9H4Bo.js";import{M as Q,C as ot,T as Ce}from"./trash-2-_aag_-5F.js";import{C as Me}from"./circle-check-big-n6hrMhEZ.js";import{U as ie}from"./user-DgrWKtiy.js";import{M as dt}from"./mail-C5qx7SDz.js";import{M as ct}from"./map-pin-DSNsGJi1.js";import{S as mt,H as xt,D as ut,W as ht}from"./wand-Bb4BsKcl.js";const gt=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]],ft=$("bell-off",gt);const pt=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],bt=$("bell",pt);const yt=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],wt=$("calendar-check",yt);const Nt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],jt=$("circle-x",Nt);const vt=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],kt=$("dollar-sign",vt);const Dt=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],we=$("eye",Dt);const Tt=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ct=$("funnel",Tt);const Mt=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],St=$("grip-vertical",Mt);const $t=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Ze=$("layout-grid",$t);const It=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],De=$("list",It);const _t=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],At=$("log-out",_t);const Pt=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Se=$("pen",Pt);const Yt=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Be=$("plus",Yt);const Ft=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ht=$("refresh-cw",Ft);const Lt=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ot=$("rotate-ccw",Lt);const Wt=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ve=$("save",Wt);const Ut=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Et=$("search",Ut);const zt=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Rt=$("settings",zt);const Kt=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Te=$("smartphone",Kt);function Ne(t){return+ye(t)<Date.now()}function Zt(t,s,a){return Ue(t,-1,a)}function E(t,s){const a=()=>at(s?.in,NaN),n=Xt(t);let o;if(n.date){const h=Gt(n.date,2);o=Qt(h.restDateString,h.year)}if(!o||isNaN(+o))return a();const d=+o;let x=0,p;if(n.time&&(x=Jt(n.time),isNaN(x)))return a();if(n.timezone){if(p=es(n.timezone),isNaN(p))return a()}else{const h=new Date(d+x),c=ye(0,s?.in);return c.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),c.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),c}return ye(d+x+p,s?.in)}const le={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Bt=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Vt=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,qt=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Xt(t){const s={},a=t.split(le.dateTimeDelimiter);let r;if(a.length>2)return s;if(/:/.test(a[0])?r=a[0]:(s.date=a[0],r=a[1],le.timeZoneDelimiter.test(s.date)&&(s.date=t.split(le.timeZoneDelimiter)[0],r=t.substr(s.date.length,t.length))),r){const n=le.timezone.exec(r);n?(s.time=r.replace(n[1],""),s.timezone=n[1]):s.time=r}return s}function Gt(t,s){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),r=t.match(a);if(!r)return{year:NaN,restDateString:""};const n=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:o===null?n:o*100,restDateString:t.slice((r[1]||r[2]).length)}}function Qt(t,s){if(s===null)return new Date(NaN);const a=t.match(Bt);if(!a)return new Date(NaN);const r=!!a[4],n=G(a[1]),o=G(a[2])-1,d=G(a[3]),x=G(a[4]),p=G(a[5])-1;if(r)return ns(s,x,p)?ts(s,x,p):new Date(NaN);{const h=new Date(0);return!as(s,o,d)||!rs(s,n)?new Date(NaN):(h.setUTCFullYear(s,o,Math.max(n,d)),h)}}function G(t){return t?parseInt(t):1}function Jt(t){const s=t.match(Vt);if(!s)return NaN;const a=he(s[1]),r=he(s[2]),n=he(s[3]);return ls(a,r,n)?a*Ee+r*ze+n*1e3:NaN}function he(t){return t&&parseFloat(t.replace(",","."))||0}function es(t){if(t==="Z")return 0;const s=t.match(qt);if(!s)return 0;const a=s[1]==="+"?-1:1,r=parseInt(s[2]),n=s[3]&&parseInt(s[3])||0;return is(r,n)?a*(r*Ee+n*ze):NaN}function ts(t,s,a){const r=new Date(0);r.setUTCFullYear(t,0,4);const n=r.getUTCDay()||7,o=(s-1)*7+a+1-n;return r.setUTCDate(r.getUTCDate()+o),r}const ss=[31,null,31,30,31,30,31,31,30,31,30,31];function qe(t){return t%400===0||t%4===0&&t%100!==0}function as(t,s,a){return s>=0&&s<=11&&a>=1&&a<=(ss[s]||(qe(t)?29:28))}function rs(t,s){return s>=1&&s<=(qe(t)?366:365)}function ns(t,s,a){return s>=1&&s<=53&&a>=0&&a<=6}function ls(t,s,a){return t===24?s===0&&a===0:a>=0&&a<60&&s>=0&&s<60&&t>=0&&t<25}function is(t,s){return s>=0&&s<=59}const os={lessThanXSeconds:{one:"أقل من ثانية",two:"أقل من ثانيتين",threeToTen:"أقل من {{count}} ثواني",other:"أقل من {{count}} ثانية"},xSeconds:{one:"ثانية واحدة",two:"ثانيتان",threeToTen:"{{count}} ثواني",other:"{{count}} ثانية"},halfAMinute:"نصف دقيقة",lessThanXMinutes:{one:"أقل من دقيقة",two:"أقل من دقيقتين",threeToTen:"أقل من {{count}} دقائق",other:"أقل من {{count}} دقيقة"},xMinutes:{one:"دقيقة واحدة",two:"دقيقتان",threeToTen:"{{count}} دقائق",other:"{{count}} دقيقة"},aboutXHours:{one:"ساعة واحدة تقريباً",two:"ساعتين تقريبا",threeToTen:"{{count}} ساعات تقريباً",other:"{{count}} ساعة تقريباً"},xHours:{one:"ساعة واحدة",two:"ساعتان",threeToTen:"{{count}} ساعات",other:"{{count}} ساعة"},xDays:{one:"يوم واحد",two:"يومان",threeToTen:"{{count}} أيام",other:"{{count}} يوم"},aboutXWeeks:{one:"أسبوع واحد تقريبا",two:"أسبوعين تقريبا",threeToTen:"{{count}} أسابيع تقريبا",other:"{{count}} أسبوعا تقريبا"},xWeeks:{one:"أسبوع واحد",two:"أسبوعان",threeToTen:"{{count}} أسابيع",other:"{{count}} أسبوعا"},aboutXMonths:{one:"شهر واحد تقريباً",two:"شهرين تقريبا",threeToTen:"{{count}} أشهر تقريبا",other:"{{count}} شهرا تقريباً"},xMonths:{one:"شهر واحد",two:"شهران",threeToTen:"{{count}} أشهر",other:"{{count}} شهرا"},aboutXYears:{one:"سنة واحدة تقريباً",two:"سنتين تقريبا",threeToTen:"{{count}} سنوات تقريباً",other:"{{count}} سنة تقريباً"},xYears:{one:"سنة واحد",two:"سنتان",threeToTen:"{{count}} سنوات",other:"{{count}} سنة"},overXYears:{one:"أكثر من سنة",two:"أكثر من سنتين",threeToTen:"أكثر من {{count}} سنوات",other:"أكثر من {{count}} سنة"},almostXYears:{one:"ما يقارب سنة واحدة",two:"ما يقارب سنتين",threeToTen:"ما يقارب {{count}} سنوات",other:"ما يقارب {{count}} سنة"}},ds=(t,s,a)=>{const r=os[t];let n;return typeof r=="string"?n=r:s===1?n=r.one:s===2?n=r.two:s<=10?n=r.threeToTen.replace("{{count}}",String(s)):n=r.other.replace("{{count}}",String(s)),a?.addSuffix?a.comparison&&a.comparison>0?"خلال "+n:"منذ "+n:n},cs={full:"EEEE، do MMMM y",long:"do MMMM y",medium:"d MMM y",short:"dd/MM/yyyy"},ms={full:"HH:mm:ss",long:"HH:mm:ss",medium:"HH:mm:ss",short:"HH:mm"},xs={full:"{{date}} 'عند الساعة' {{time}}",long:"{{date}} 'عند الساعة' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},us={date:ue({formats:cs,defaultWidth:"full"}),time:ue({formats:ms,defaultWidth:"full"}),dateTime:ue({formats:xs,defaultWidth:"full"})},hs={lastWeek:"eeee 'الماضي عند الساعة' p",yesterday:"'الأمس عند الساعة' p",today:"'اليوم عند الساعة' p",tomorrow:"'غدا عند الساعة' p",nextWeek:"eeee 'القادم عند الساعة' p",other:"P"},gs=t=>hs[t],fs={narrow:["ق","ب"],abbreviated:["ق.م.","ب.م."],wide:["قبل الميلاد","بعد الميلاد"]},ps={narrow:["1","2","3","4"],abbreviated:["ر1","ر2","ر3","ر4"],wide:["الربع الأول","الربع الثاني","الربع الثالث","الربع الرابع"]},bs={narrow:["ي","ف","م","أ","م","ي","ي","أ","س","أ","ن","د"],abbreviated:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],wide:["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"]},ys={narrow:["ح","ن","ث","ر","خ","ج","س"],short:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],abbreviated:["أحد","اثنين","ثلاثاء","أربعاء","خميس","جمعة","سبت"],wide:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"]},ws={narrow:{am:"ص",pm:"م",morning:"الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"المساء",night:"الليل",midnight:"منتصف الليل"},abbreviated:{am:"ص",pm:"م",morning:"الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"المساء",night:"الليل",midnight:"منتصف الليل"},wide:{am:"ص",pm:"م",morning:"الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"المساء",night:"الليل",midnight:"منتصف الليل"}},Ns={narrow:{am:"ص",pm:"م",morning:"في الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل",midnight:"منتصف الليل"},abbreviated:{am:"ص",pm:"م",morning:"في الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل",midnight:"منتصف الليل"},wide:{am:"ص",pm:"م",morning:"في الصباح",noon:"الظهر",afternoon:"بعد الظهر",evening:"في المساء",night:"في الليل",midnight:"منتصف الليل"}},js=t=>String(t),vs={ordinalNumber:js,era:q({values:fs,defaultWidth:"wide"}),quarter:q({values:ps,defaultWidth:"wide",argumentCallback:t=>t-1}),month:q({values:bs,defaultWidth:"wide"}),day:q({values:ys,defaultWidth:"wide"}),dayPeriod:q({values:ws,defaultWidth:"wide",formattingValues:Ns,defaultFormattingWidth:"wide"})},ks=/^(\d+)(th|st|nd|rd)?/i,Ds=/\d+/i,Ts={narrow:/[قب]/,abbreviated:/[قب]\.م\./,wide:/(قبل|بعد) الميلاد/},Cs={any:[/قبل/,/بعد/]},Ms={narrow:/^[1234]/i,abbreviated:/ر[1234]/,wide:/الربع (الأول|الثاني|الثالث|الرابع)/},Ss={any:[/1/i,/2/i,/3/i,/4/i]},$s={narrow:/^[أيفمسند]/,abbreviated:/^(يناير|فبراير|مارس|أبريل|مايو|يونيو|يوليو|أغسطس|سبتمبر|أكتوبر|نوفمبر|ديسمبر)/,wide:/^(يناير|فبراير|مارس|أبريل|مايو|يونيو|يوليو|أغسطس|سبتمبر|أكتوبر|نوفمبر|ديسمبر)/},Is={narrow:[/^ي/i,/^ف/i,/^م/i,/^أ/i,/^م/i,/^ي/i,/^ي/i,/^أ/i,/^س/i,/^أ/i,/^ن/i,/^د/i],any:[/^يناير/i,/^فبراير/i,/^مارس/i,/^أبريل/i,/^مايو/i,/^يونيو/i,/^يوليو/i,/^أغسطس/i,/^سبتمبر/i,/^أكتوبر/i,/^نوفمبر/i,/^ديسمبر/i]},_s={narrow:/^[حنثرخجس]/i,short:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/i,abbreviated:/^(أحد|اثنين|ثلاثاء|أربعاء|خميس|جمعة|سبت)/i,wide:/^(الأحد|الاثنين|الثلاثاء|الأربعاء|الخميس|الجمعة|السبت)/i},As={narrow:[/^ح/i,/^ن/i,/^ث/i,/^ر/i,/^خ/i,/^ج/i,/^س/i],wide:[/^الأحد/i,/^الاثنين/i,/^الثلاثاء/i,/^الأربعاء/i,/^الخميس/i,/^الجمعة/i,/^السبت/i],any:[/^أح/i,/^اث/i,/^ث/i,/^أر/i,/^خ/i,/^ج/i,/^س/i]},Ps={narrow:/^(ص|م|منتصف الليل|الظهر|بعد الظهر|في الصباح|في المساء|في الليل)/,any:/^(ص|م|منتصف الليل|الظهر|بعد الظهر|في الصباح|في المساء|في الليل)/},Ys={any:{am:/^ص/,pm:/^م/,midnight:/منتصف الليل/,noon:/الظهر/,afternoon:/بعد الظهر/,morning:/في الصباح/,evening:/في المساء/,night:/في الليل/}},Fs={ordinalNumber:rt({matchPattern:ks,parsePattern:Ds,valueCallback:t=>parseInt(t,10)}),era:X({matchPatterns:Ts,defaultMatchWidth:"wide",parsePatterns:Cs,defaultParseWidth:"any"}),quarter:X({matchPatterns:Ms,defaultMatchWidth:"wide",parsePatterns:Ss,defaultParseWidth:"any",valueCallback:t=>t+1}),month:X({matchPatterns:$s,defaultMatchWidth:"wide",parsePatterns:Is,defaultParseWidth:"any"}),day:X({matchPatterns:_s,defaultMatchWidth:"wide",parsePatterns:As,defaultParseWidth:"any"}),dayPeriod:X({matchPatterns:Ps,defaultMatchWidth:"any",parsePatterns:Ys,defaultParseWidth:"any"})},te={code:"ar",formatDistance:ds,formatLong:us,formatRelative:gs,localize:vs,match:Fs,options:{weekStartsOn:6,firstWeekContainsDate:1}},Hs=({children:t,sidebar:s,header:a})=>{const{i18n:r}=_(),n=r.dir();return e.jsxs("div",{className:"h-screen bg-dark-900 flex flex-col overflow-hidden",dir:n,children:[e.jsx("div",{className:"flex-none z-20 bg-dark-800 border-b border-white/10 shadow-md",children:a}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("main",{className:"flex-1 overflow-y-auto bg-dark-900 relative scrollbar-thin scrollbar-thumb-dark-700 scrollbar-track-transparent",children:e.jsx("div",{className:"min-h-full p-4 lg:p-6",children:t})}),e.jsx("aside",{className:"w-80 flex-none bg-dark-800 border-l border-white/10 hidden lg:flex flex-col h-full z-10 shadow-[-4px_0_15px_-3px_rgba(0,0,0,0.3)]",children:s})]})]})},Ls=({activeView:t,setActiveView:s,searchQuery:a,setSearchQuery:r,statusFilter:n,setStatusFilter:o,dateFilter:d,setDateFilter:x,onRefresh:p,onLogout:h,onNewAppointment:c,stats:u})=>{function k(w){const T="=".repeat((4-w.length%4)%4),I=(w+T).replace(/-/g,"+").replace(/_/g,"/"),C=window.atob(I),P=new Uint8Array(C.length);for(let l=0;l<C.length;++l)P[l]=C.charCodeAt(l);return P}const{t:b}=_("admin"),[v,y]=g.useState(!1),[m,f]=g.useState(!1);g.useEffect(()=>{"serviceWorker"in navigator&&"PushManager"in window?(f(!0),navigator.serviceWorker.ready.then(w=>{w.pushManager.getSubscription().then(T=>{y(!!T)})},w=>console.error("Service Worker ready failed:",w))):console.log("Push messaging not supported")},[]);const N=async()=>{if(m)try{if(console.log("Requesting notification permission..."),await Notification.requestPermission()!=="granted"){alert("Permission denied");return}console.log("Registering push...");const T=await navigator.serviceWorker.ready,I=void 0;if(!I){console.error("Missing VAPID key"),alert("Configuration error: Missing public key");return}const C=await T.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:k(I)});console.log("Sending subscription to server..."),await S.post("/notifications/subscribe",C),y(!0),alert("Notifications Enabled! You will be notified of new bookings.")}catch(w){console.error("Failed to subscribe:",w),alert("Failed to enable notifications: "+(w.message||"Unknown error"))}};return e.jsxs("div",{className:"flex flex-col bg-dark-800 border-b border-white/10",children:[u.pending>0&&e.jsxs("div",{className:"bg-yellow-500/10 border-b border-yellow-500/20 px-3 md:px-6 py-2 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 md:w-8 md:h-8 bg-yellow-500 rounded-full animate-pulse flex-shrink-0",children:e.jsx("span",{className:"text-dark-900 font-bold text-xs md:text-sm",children:u.pending})}),e.jsx("span",{className:"text-yellow-400 font-medium text-xs md:text-sm",children:u.pending===1?b("notifications.pendingOne"):b("notifications.pendingMultiple",{count:u.pending})})]}),e.jsx("button",{onClick:()=>{o("pending"),x(""),s("appointments")},className:"text-xs font-bold text-yellow-400 hover:text-yellow-300 bg-yellow-500/20 hover:bg-yellow-500/30 px-2 md:px-3 py-1 md:py-1.5 rounded-lg transition-colors whitespace-nowrap flex-shrink-0",children:b("notifications.viewPending")})]}),e.jsxs("div",{className:"flex items-center justify-between px-3 md:px-6 py-2 md:py-3 border-b border-white/5",children:[e.jsx("h1",{className:"text-base md:text-xl font-bold text-white tracking-tight",children:b("title")}),e.jsxs("div",{className:"flex items-center gap-1 md:gap-3",children:[m&&e.jsx("button",{onClick:N,disabled:v,className:`inline-flex items-center justify-center w-9 h-9 md:w-10 md:h-10 rounded-lg transition-colors ${v?"text-green-500 bg-green-500/10 cursor-default":"text-gray-400 hover:text-white hover:bg-white/10"}`,title:v?"Notifications Enabled":"Enable Notifications",children:v?e.jsx(bt,{className:"h-4 w-4 flex-shrink-0"}):e.jsx(ft,{className:"h-4 w-4 flex-shrink-0"})}),e.jsx("div",{children:e.jsx(st,{})}),e.jsxs("button",{onClick:c,className:"inline-flex items-center justify-center gap-1 md:gap-2 px-2.5 md:px-4 py-2 md:py-2 bg-gold-500 hover:bg-gold-400 text-dark-900 rounded-lg text-xs md:text-sm font-bold transition-all",children:[e.jsx(Be,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"hidden md:inline",children:b("actions.add")})]}),e.jsx("button",{onClick:p,className:"inline-flex items-center justify-center w-9 h-9 md:w-10 md:h-10 hover:bg-white/10 rounded-lg transition-colors text-gray-400 hover:text-white",title:b("actions.refresh"),children:e.jsx(Ht,{className:"h-4 w-4 flex-shrink-0"})}),e.jsx("button",{onClick:h,className:"inline-flex items-center justify-center w-9 h-9 md:w-10 md:h-10 hover:bg-red-500/10 rounded-lg transition-colors text-red-500/70 hover:text-red-500",title:b("actions.logout"),children:e.jsx(At,{className:"h-4 w-4 flex-shrink-0"})})]})]}),e.jsx("div",{className:"overflow-x-auto scrollbar-hide border-b border-white/5",children:e.jsxs("div",{className:"inline-flex bg-dark-900/30 p-1 min-w-full",children:[e.jsxs("button",{onClick:()=>s("today"),className:`inline-flex items-center justify-center gap-1.5 md:gap-2 px-3 md:px-6 py-2 md:py-2.5 rounded-md text-xs md:text-sm font-bold uppercase tracking-wider transition-all relative whitespace-nowrap ${t==="today"?"bg-gold-500 text-dark-900":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx(wt,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:b("views.today")}),u.pending>0&&t!=="today"&&e.jsx("span",{className:"absolute -top-1 -right-1 flex items-center justify-center min-w-4 h-4 bg-yellow-500 text-dark-900 text-[10px] font-bold rounded-full px-1 animate-pulse",children:u.pending})]}),e.jsxs("button",{onClick:()=>s("appointments"),className:`inline-flex items-center justify-center gap-1.5 md:gap-2 px-3 md:px-6 py-2 md:py-2.5 rounded-md text-xs md:text-sm font-bold uppercase tracking-wider transition-all whitespace-nowrap ${t==="appointments"?"bg-gold-500 text-dark-900":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx(De,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:b("views.all")})]}),e.jsxs("button",{onClick:()=>s("availability"),className:`inline-flex items-center justify-center gap-1.5 md:gap-2 px-3 md:px-6 py-2 md:py-2.5 rounded-md text-xs md:text-sm font-bold uppercase tracking-wider transition-all whitespace-nowrap ${t==="availability"?"bg-gold-500 text-dark-900":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx(Rt,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:b("views.availability")})]}),e.jsxs("button",{onClick:()=>s("services"),className:`inline-flex items-center justify-center gap-1.5 md:gap-2 px-3 md:px-6 py-2 md:py-2.5 rounded-md text-xs md:text-sm font-bold uppercase tracking-wider transition-all whitespace-nowrap ${t==="services"?"bg-gold-500 text-dark-900":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx(ve,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{children:b("views.services")})]})]})}),t==="appointments"&&e.jsx("div",{className:"px-3 md:px-6 py-2 md:py-3 bg-dark-900/30",children:e.jsxs("div",{className:"grid grid-cols-1 md:flex md:items-center gap-2 md:gap-4",children:[e.jsxs("div",{className:"relative flex-1 md:max-w-[220px]",children:[e.jsx(Et,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 rtl:left-auto rtl:right-3 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:b("filters.search"),value:a,onChange:w=>r(w.target.value),className:"w-full bg-dark-900 border border-white/10 rounded-xl pl-9 pr-3 py-2 text-sm text-white placeholder-gray-600 focus:border-gold-500/50 focus:ring-1 focus:ring-gold-500/50 outline-none transition-colors h-12 md:h-9 rtl:pl-3 rtl:pr-9"})]}),e.jsxs("div",{className:"relative md:w-36",children:[e.jsx(Ct,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-500 rtl:left-auto rtl:right-3 pointer-events-none"}),e.jsxs("select",{value:n,onChange:w=>o(w.target.value),className:"w-full bg-dark-900 border border-white/10 rounded-xl pl-9 pr-2 py-2 text-sm text-white focus:border-gold-500/50 outline-none cursor-pointer h-12 md:h-9 appearance-none rtl:pl-2 rtl:pr-9",children:[e.jsx("option",{value:"all",children:b("filters.allStatuses")}),e.jsx("option",{value:"pending",children:b("filters.pending")}),e.jsx("option",{value:"confirmed",children:b("filters.confirmed")}),e.jsx("option",{value:"cancelled",children:b("filters.cancelled")})]}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none rtl:right-auto rtl:left-3",children:e.jsx("svg",{className:"h-4 w-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsxs("div",{className:"relative md:w-36",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-500 rtl:left-auto rtl:right-3 pointer-events-none"}),e.jsx("input",{type:"date",value:d,onChange:w=>x(w.target.value),className:"w-full bg-dark-900 border border-white/10 rounded-xl pl-9 pr-2 py-2 text-sm text-white focus:border-gold-500/50 outline-none cursor-pointer h-12 md:h-9 rtl:pl-2 rtl:pr-9 appearance-none"})]}),(d||n!=="all")&&e.jsxs("button",{onClick:()=>{x(""),o("all")},className:"w-full md:w-auto px-4 py-2 bg-dark-800 hover:bg-dark-700 border border-white/10 rounded-xl text-sm font-bold text-gray-400 hover:text-white transition-colors h-12 md:h-9 flex items-center justify-center gap-2",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-x",children:[e.jsx("path",{d:"M18 6 6 18"}),e.jsx("path",{d:"m6 6 12 12"})]}),b("actions.reset")]}),e.jsxs("div",{className:"hidden lg:flex items-center gap-4 px-4 border-l border-white/10 rtl:border-l-0 rtl:border-r ml-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wider font-bold",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500"}),e.jsxs("span",{className:"text-gray-400",children:[b("stats.pending"),":"]}),e.jsx("span",{className:"text-white",children:u.pending})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs uppercase tracking-wider font-bold",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsxs("span",{className:"text-gray-400",children:[b("stats.confirmed"),":"]}),e.jsx("span",{className:"text-white",children:u.confirmed})]})]})]})})]})},Xe=({appointment:t,serviceNames:s,onViewDetails:a,variant:r="grid"})=>{const{t:n,i18n:o}=_("admin"),d=o.language==="ar"?te:ee,x=y=>{switch(y){case"phone":return e.jsx(J,{className:"h-3.5 w-3.5 text-blue-400"});case"whatsapp":return e.jsx(Q,{className:"h-3.5 w-3.5 text-green-400"});case"walk-in":return e.jsx(Te,{className:"h-3.5 w-3.5 text-purple-400"});default:return e.jsx(ke,{className:"h-3.5 w-3.5 text-gray-400"})}},p=y=>{switch(y){case"phone":return n("source.phone");case"whatsapp":return n("source.whatsapp");case"walk-in":return n("source.walkIn");default:return n("source.web")}},h=y=>{switch(y){case"confirmed":return"bg-green-500/10 text-green-400 border-green-500/30";case"cancelled":return"bg-red-500/10 text-red-400 border-red-500/30";default:return"bg-yellow-500/10 text-yellow-500 border-yellow-500/30"}},c=y=>n(`status.${y}`),u=t.status==="pending",k=t.status==="cancelled",b=E(`${t.appointmentDate}T${t.appointmentTime}`),v=Ne(b);return r==="list"?e.jsxs("div",{className:`group flex items-center gap-4 p-4 bg-dark-800 border rounded-lg transition-all hover:border-gold-500/50 ${k?"opacity-60 grayscale":v&&!k?"opacity-75":""} ${u?"border-yellow-500/30 shadow-[0_0_10px_-5px_rgba(234,179,8,0.2)]":"border-white/10"}`,children:[e.jsxs("div",{className:"flex flex-col min-w-[120px]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-lg font-bold text-white font-mono",children:t.appointmentTime}),t.totalDuration&&e.jsxs("span",{className:"text-xs text-gray-500 bg-dark-700 px-1.5 py-0.5 rounded",children:[t.totalDuration," min"]}),u&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"})]}),e.jsx("div",{className:"text-xs text-gray-500",children:M(E(t.appointmentDate),"dd MMM",{locale:d})})]}),e.jsxs("div",{className:"flex-1 min-w-0 text-left rtl:text-right",children:[e.jsx("div",{className:"text-sm font-bold text-white mb-0.5",children:t.fullName}),e.jsx("div",{className:"text-xs text-gray-400 font-mono",children:t.phone})]}),e.jsx("div",{className:"flex-1 min-w-0 text-left rtl:text-right hidden md:block",children:e.jsx("div",{className:"text-xs text-gray-400 line-clamp-1",children:s})}),e.jsx("div",{className:"text-right min-w-[80px] rtl:text-left",children:e.jsxs("div",{className:"text-sm font-bold text-gold-500",children:[t.totalPrice," RON"]})}),e.jsx("div",{className:"min-w-[90px] hidden sm:block",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider border ${h(t.status)}`,children:c(t.status)})}),e.jsx("div",{className:"min-w-[40px] hidden lg:block",children:e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-dark-900/50 rounded-md border border-white/10",title:p(t.source),children:x(t.source)})}),e.jsx("div",{className:"flex gap-1 min-w-[100px] justify-end rtl:justify-start",children:e.jsx("button",{onClick:()=>a(t),className:"p-1.5 hover:bg-dark-700 rounded-md text-gray-400 hover:text-white transition-colors",title:n("actions.view"),children:e.jsx(we,{className:"h-4 w-4"})})})]}):e.jsxs("div",{className:`group relative bg-dark-800 border rounded-xl p-4 transition-all hover:border-gold-500/50 hover:shadow-lg hover:shadow-gold-500/10 ${k?"opacity-60 grayscale":v&&!k?"opacity-75":""} ${u?"border-yellow-500/30 shadow-[0_0_15px_-5px_rgba(234,179,8,0.2)]":"border-white/10"}`,children:[u&&e.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-gold-500 to-transparent"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0 text-left rtl:text-right",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[e.jsx("span",{className:"text-xl font-bold text-white font-mono",children:t.appointmentTime}),t.totalDuration&&e.jsxs("span",{className:"text-xs text-gray-500 bg-dark-700 px-1.5 py-0.5 rounded",children:[t.totalDuration," min"]}),u&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"})]}),e.jsx("span",{className:"text-xs text-gray-400 font-medium",children:M(E(t.appointmentDate),"EEEE, dd MMMM yyyy",{locale:d})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-bold text-white mb-0.5 truncate",children:t.fullName}),e.jsx("div",{className:"text-xs text-gray-400 font-mono",children:t.phone})]}),e.jsx("div",{className:"text-xs text-gray-400 line-clamp-2",children:s})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between min-w-[120px] rtl:items-start",children:[e.jsx("div",{className:"text-right mb-2 rtl:text-left",children:e.jsxs("div",{className:"text-lg font-bold text-gold-500",children:[t.totalPrice," RON"]})}),e.jsxs("div",{className:"flex flex-col gap-2 items-end mb-2 rtl:items-start",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider border ${h(t.status)}`,children:c(t.status)}),e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-dark-900/50 rounded-md border border-white/10",children:[x(t.source),e.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-medium",children:p(t.source)})]})]}),e.jsx("div",{className:"flex gap-1",children:e.jsx("button",{onClick:()=>a(t),className:"p-1.5 hover:bg-dark-700 rounded-md text-gray-400 hover:text-white transition-colors",title:n("actions.view"),children:e.jsx(we,{className:"h-4 w-4"})})})]})]}),v&&!k&&e.jsx("div",{className:"absolute top-2 left-2 rtl:left-auto rtl:right-2",children:e.jsx("span",{className:"text-[9px] uppercase tracking-wider font-bold text-gray-600 bg-dark-900/80 px-1.5 py-0.5 rounded",children:n("status.past")})})]})},Os=({appointments:t,services:s,loading:a,currentPage:r,totalPages:n,totalItems:o,onPageChange:d,onStatusUpdate:x,onViewDetails:p})=>{const{t:h}=_("admin"),{t:c}=_("common"),[u,k]=g.useState("grid"),b=m=>{if(m.nameKey){const f=c(`services_data.${m.nameKey}.name`,{defaultValue:""});if(f&&f!==`services_data.${m.nameKey}.name`)return f}return m.name},v=m=>m.map(f=>{const N=s.find(w=>w.id===f);return N?b(N):null}).filter(Boolean).join(", "),y=()=>e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-dark-800/50 rounded-lg border border-white/5",children:[e.jsxs("div",{className:"text-xs text-gray-400",children:[h("pagination.page")," ",e.jsx("span",{className:"font-bold text-white",children:r})," ",h("pagination.of")," ",e.jsx("span",{className:"font-bold text-white",children:n}),e.jsxs("span",{className:"hidden sm:inline ml-2 rtl:ml-0 rtl:mr-2",children:["• ",e.jsx("span",{className:"font-medium text-white",children:o})," ",h("pagination.appointments")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>d(r-1),disabled:r===1,className:"flex items-center gap-1 px-3 py-1.5 rounded-lg bg-dark-700 hover:bg-dark-600 disabled:opacity-30 disabled:cursor-not-allowed transition-colors text-gray-400 hover:text-white text-xs font-medium",children:[e.jsx(Re,{className:"h-3.5 w-3.5 rtl:rotate-180"}),e.jsx("span",{className:"hidden sm:inline",children:h("actions.previous")})]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,n)},(m,f)=>{let N=f+1;return n>5&&r>3&&(N=r-2+f),N>n?null:e.jsx("button",{onClick:()=>d(N),className:`w-8 h-8 rounded-lg text-xs font-bold transition-all ${r===N?"bg-gold-500 text-dark-900 shadow-lg shadow-gold-500/20":"bg-dark-700 text-gray-400 hover:bg-dark-600 hover:text-white"}`,children:N},N)})}),e.jsxs("button",{onClick:()=>d(r+1),disabled:r===n,className:"flex items-center gap-1 px-3 py-1.5 rounded-lg bg-dark-700 hover:bg-dark-600 disabled:opacity-30 disabled:cursor-not-allowed transition-colors text-gray-400 hover:text-white text-xs font-medium",children:[e.jsx("span",{className:"hidden sm:inline",children:h("actions.next")}),e.jsx(We,{className:"h-3.5 w-3.5 rtl:rotate-180"})]})]})]});return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row gap-3 sm:gap-4 justify-between items-stretch sm:items-center",children:[e.jsxs("div",{className:"flex bg-dark-800 p-1 rounded-lg border border-white/10 self-start",children:[e.jsxs("button",{onClick:()=>k("grid"),className:`flex items-center gap-1.5 px-2.5 md:px-4 py-1.5 md:py-2 rounded-md transition-all text-xs md:text-sm font-medium ${u==="grid"?"bg-gold-500 text-dark-900 shadow-sm":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:h("views.grid")})]}),e.jsxs("button",{onClick:()=>k("list"),className:`flex items-center gap-1.5 px-2.5 md:px-4 py-1.5 md:py-2 rounded-md transition-all text-xs md:text-sm font-medium ${u==="list"?"bg-gold-500 text-dark-900 shadow-sm":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[e.jsx(De,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:h("views.list")})]})]}),e.jsx("div",{className:"flex-1 w-full sm:w-auto",children:y()})]}),e.jsx("div",{className:"flex-1 overflow-auto scrollbar-thin scrollbar-thumb-dark-600",children:a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-gold-500"})}):t.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500 text-sm mb-2",children:h("messages.noAppointments")}),e.jsx("div",{className:"text-gray-600 text-xs",children:h("messages.tryAdjust")})]})}):e.jsx("div",{className:u==="grid"?"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 pb-4":"flex flex-col gap-3 pb-4",children:t.map(m=>e.jsx(Xe,{appointment:m,serviceNames:v(m.services),onStatusUpdate:x,onViewDetails:p,variant:u},m.id))})}),!a&&t.length>0&&e.jsx("div",{className:"mt-4",children:y()})]})},Ws=({appointments:t,services:s,loading:a,selectedDate:r,onDateChange:n,onStatusUpdate:o,onViewDetails:d})=>{const{t:x,i18n:p}=_("admin"),{t:h}=_("common"),c=p.language==="ar"?te:ee,[u,k]=g.useState("list"),b=i=>{if(i.nameKey){const D=h(`services_data.${i.nameKey}.name`,{defaultValue:""});if(D&&D!==`services_data.${i.nameKey}.name`)return D}return i.name},v=i=>i.map(D=>{const Y=s.find(F=>F.id===D);return Y?b(Y):null}).filter(Boolean).join(", "),y=i=>{switch(i){case"phone":return e.jsx(J,{className:"h-3 w-3 text-blue-400"});case"whatsapp":return e.jsx(Q,{className:"h-3 w-3 text-green-400"});case"walk-in":return e.jsx(Te,{className:"h-3 w-3 text-purple-400"});default:return e.jsx(ke,{className:"h-3 w-3 text-gray-400"})}},m=i=>{switch(i){case"confirmed":return"bg-green-500/10 text-green-400 border-green-500/30";case"cancelled":return"bg-red-500/10 text-red-400 border-red-500/30";default:return"bg-yellow-500/10 text-yellow-500 border-yellow-500/30"}},f=i=>x(`status.${i}`),N=[...t].sort((i,D)=>i.appointmentTime.localeCompare(D.appointmentTime)),w=N.filter(i=>i.status==="pending"),T=N.filter(i=>i.status==="confirmed"),I=N.filter(i=>i.status==="cancelled"),C={total:t.length,pending:w.length,confirmed:T.length,cancelled:I.length,totalRevenue:t.filter(i=>i.status!=="cancelled").reduce((i,D)=>i+D.totalPrice,0)},P=({appointment:i})=>{const D=i.status==="pending",Y=i.status==="cancelled",F=E(`${i.appointmentDate}T${i.appointmentTime}`),W=Ne(F);return e.jsxs("div",{onClick:()=>d(i),className:`p-3 bg-dark-800 border rounded-lg transition-all cursor-pointer active:scale-[0.98] ${Y?"opacity-60":W&&!Y?"opacity-75":""} ${D?"border-yellow-500/30":"border-white/10"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-3.5 w-3.5 text-gray-500"}),e.jsx("span",{className:"text-sm font-bold text-white font-mono",children:i.appointmentTime}),D&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"})]}),e.jsxs("span",{className:"text-sm font-bold text-gold-500",children:[i.totalPrice," RON"]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-white truncate",children:i.fullName}),e.jsx("div",{className:"text-xs text-gray-400 font-mono",children:i.phone})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[y(i.source),e.jsx("span",{className:"text-xs text-gray-500 truncate",children:v(i.services)})]}),e.jsx("div",{className:"flex items-center gap-1 ml-2",children:e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase border ${m(i.status)}`,children:f(i.status)})})]})]})},l=({appointment:i})=>{const D=i.status==="pending",Y=i.status==="cancelled",F=E(`${i.appointmentDate}T${i.appointmentTime}`),W=Ne(F);return e.jsxs("div",{className:`group flex items-center gap-4 p-4 bg-dark-800 border rounded-lg transition-all hover:border-gold-500/50 ${Y?"opacity-60 grayscale":W&&!Y?"opacity-75":""} ${D?"border-yellow-500/30 shadow-[0_0_10px_-5px_rgba(234,179,8,0.2)]":"border-white/10"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-[100px]",children:[e.jsx(O,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-lg font-bold text-white font-mono",children:i.appointmentTime}),D&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"})]}),e.jsxs("div",{className:"flex-1 min-w-0 text-left rtl:text-right",children:[e.jsx("div",{className:"text-sm font-bold text-white mb-0.5",children:i.fullName}),e.jsx("div",{className:"text-xs text-gray-400 font-mono",children:i.phone})]}),e.jsx("div",{className:"flex-1 min-w-0 text-left rtl:text-right",children:e.jsx("div",{className:"text-xs text-gray-400 line-clamp-1",children:v(i.services)})}),e.jsx("div",{className:"text-right min-w-[80px] rtl:text-left",children:e.jsxs("div",{className:"text-sm font-bold text-gold-500",children:[i.totalPrice," RON"]})}),e.jsx("div",{className:"min-w-[90px] flex justify-center",children:e.jsx("span",{className:`inline-flex items-center justify-center px-2 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider border ${m(i.status)}`,children:f(i.status)})}),e.jsx("div",{className:"min-w-[40px] flex justify-center",children:e.jsx("div",{className:"flex items-center justify-center gap-1.5 px-2 py-1 bg-dark-900/50 rounded-md border border-white/10",title:i.source,children:y(i.source)})}),e.jsx("div",{className:"flex gap-1 min-w-[100px] justify-end rtl:justify-start",children:e.jsx("button",{onClick:()=>d(i),className:"p-1.5 hover:bg-dark-700 rounded-md text-gray-400 hover:text-white transition-colors",title:x("actions.view"),children:e.jsx(we,{className:"h-4 w-4"})})})]})};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"mb-4 md:mb-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-3 md:mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-gold-500"}),e.jsx("h2",{className:"text-lg md:text-2xl font-bold text-white",children:x("todayView.title")})]}),e.jsxs("div",{className:"flex bg-dark-800 p-1 rounded-lg border border-white/10",children:[e.jsxs("button",{onClick:()=>k("grid"),className:`p-1.5 md:px-3 md:py-1.5 rounded-md transition-all flex items-center gap-1.5 ${u==="grid"?"bg-gold-500 text-dark-900":"text-gray-400 hover:text-white"}`,children:[e.jsx(Ze,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline text-xs font-medium",children:x("views.grid")})]}),e.jsxs("button",{onClick:()=>k("list"),className:`p-1.5 md:px-3 md:py-1.5 rounded-md transition-all flex items-center gap-1.5 ${u==="list"?"bg-gold-500 text-dark-900":"text-gray-400 hover:text-white"}`,children:[e.jsx(De,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline text-xs font-medium",children:x("views.list")})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("button",{onClick:()=>n(M(Zt(E(r)),"yyyy-MM-dd")),className:"p-2 bg-dark-800 border border-white/10 rounded-lg text-gray-400 active:bg-dark-700",children:e.jsx(Re,{className:"h-4 w-4 rtl:rotate-180"})}),e.jsxs("div",{className:"flex-1 flex items-center justify-center gap-2 bg-dark-800 border border-white/10 rounded-lg px-3 py-2",children:[e.jsx("input",{type:"date",value:r,onChange:i=>n(i.target.value),className:"bg-transparent border-none text-white font-medium text-sm focus:outline-none cursor-pointer"}),e.jsx("span",{className:"text-xs text-gray-400 hidden md:inline",children:M(E(r),"EEEE",{locale:c})})]}),r!==M(new Date,"yyyy-MM-dd")?e.jsx("button",{onClick:()=>n(M(new Date,"yyyy-MM-dd")),className:"px-3 py-2 bg-gold-500 text-dark-900 rounded-lg text-xs font-bold",children:x("actions.today")}):e.jsx("button",{onClick:()=>n(M(Ue(E(r),1),"yyyy-MM-dd")),className:"p-2 bg-dark-800 border border-white/10 rounded-lg text-gray-400 active:bg-dark-700",children:e.jsx(We,{className:"h-4 w-4 rtl:rotate-180"})})]})]}),e.jsx("div",{className:"overflow-x-auto scrollbar-hide -mx-3 px-3 md:mx-0 md:px-0",children:e.jsxs("div",{className:"flex md:grid md:grid-cols-5 gap-1.5 md:gap-3 min-w-max md:min-w-0",children:[e.jsxs("div",{className:"bg-dark-800 border border-white/10 rounded-lg p-2 md:p-3 min-w-[70px] md:min-w-0 flex flex-col items-center md:items-start text-center md:text-left",children:[e.jsx("div",{className:"text-[9px] md:text-xs text-gray-400 uppercase tracking-wider mb-0.5 md:mb-1",children:x("stats.total")}),e.jsx("div",{className:"text-lg md:text-2xl font-bold text-white leading-none md:leading-normal",children:C.total})]}),e.jsxs("div",{className:"bg-dark-800 border border-yellow-500/30 rounded-lg p-2 md:p-3 min-w-[70px] md:min-w-0 flex flex-col items-center md:items-start text-center md:text-left",children:[e.jsx("div",{className:"text-[9px] md:text-xs text-gray-400 uppercase tracking-wider mb-0.5 md:mb-1",children:x("stats.pending")}),e.jsx("div",{className:"text-lg md:text-2xl font-bold text-yellow-500 leading-none md:leading-normal",children:C.pending})]}),e.jsxs("div",{className:"bg-dark-800 border border-green-500/30 rounded-lg p-2 md:p-3 min-w-[70px] md:min-w-0 flex flex-col items-center md:items-start text-center md:text-left",children:[e.jsx("div",{className:"text-[9px] md:text-xs text-gray-400 uppercase tracking-wider mb-0.5 md:mb-1",children:x("stats.confirmed")}),e.jsx("div",{className:"text-lg md:text-2xl font-bold text-green-500 leading-none md:leading-normal",children:C.confirmed})]}),e.jsxs("div",{className:"bg-dark-800 border border-red-500/30 rounded-lg p-2 md:p-3 min-w-[70px] md:min-w-0 flex flex-col items-center md:items-start text-center md:text-left",children:[e.jsx("div",{className:"text-[9px] md:text-xs text-gray-400 uppercase tracking-wider mb-0.5 md:mb-1",children:x("stats.cancelled")}),e.jsx("div",{className:"text-lg md:text-2xl font-bold text-red-500 leading-none md:leading-normal",children:C.cancelled})]}),e.jsxs("div",{className:"bg-dark-800 border border-gold-500/30 rounded-lg p-2 md:p-3 min-w-[90px] md:min-w-0 flex flex-col items-center md:items-start text-center md:text-left",children:[e.jsx("div",{className:"text-[9px] md:text-xs text-gray-400 uppercase tracking-wider mb-0.5 md:mb-1",children:x("stats.estimatedRevenue")}),e.jsxs("div",{className:"text-lg md:text-2xl font-bold text-gold-500 leading-none md:leading-normal",children:[C.totalRevenue," ",e.jsx("span",{className:"text-xs md:text-lg",children:"RON"})]})]})]})})]}),e.jsx("div",{className:"flex-1 overflow-auto scrollbar-thin scrollbar-thumb-dark-600",children:a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-gold-500"})}):t.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(K,{className:"h-12 w-12 text-gray-600 mx-auto mb-3"}),e.jsx("div",{className:"text-gray-500 text-sm mb-2",children:x("todayView.noAppointments")}),e.jsx("div",{className:"text-gray-600 text-xs",children:x("todayView.freeDay")})]})}):u==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3 md:gap-4 pb-4",children:N.map(i=>e.jsx(Xe,{appointment:i,serviceNames:v(i.services),onStatusUpdate:o,onViewDetails:d,variant:"grid"},i.id))}):e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[w.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 md:mb-3",children:[e.jsx("div",{className:"h-px flex-1 bg-yellow-500/20"}),e.jsxs("h3",{className:"text-xs uppercase tracking-wider font-bold text-yellow-500",children:[x("todayView.inProgress")," (",w.length,")"]}),e.jsx("div",{className:"h-px flex-1 bg-yellow-500/20"})]}),e.jsxs("div",{className:"space-y-2",children:[w.map(i=>e.jsx("div",{className:"hidden md:block",children:e.jsx(l,{appointment:i})},i.id)),w.map(i=>e.jsx("div",{className:"md:hidden",children:e.jsx(P,{appointment:i})},i.id))]})]}),T.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 md:mb-3",children:[e.jsx("div",{className:"h-px flex-1 bg-green-500/20"}),e.jsxs("h3",{className:"text-xs uppercase tracking-wider font-bold text-green-500",children:[x("todayView.confirmedSection")," (",T.length,")"]}),e.jsx("div",{className:"h-px flex-1 bg-green-500/20"})]}),e.jsxs("div",{className:"space-y-2",children:[T.map(i=>e.jsx("div",{className:"hidden md:block",children:e.jsx(l,{appointment:i})},i.id)),T.map(i=>e.jsx("div",{className:"md:hidden",children:e.jsx(P,{appointment:i})},i.id))]})]}),I.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 md:mb-3",children:[e.jsx("div",{className:"h-px flex-1 bg-red-500/20"}),e.jsxs("h3",{className:"text-xs uppercase tracking-wider font-bold text-red-500",children:[x("todayView.cancelledSection")," (",I.length,")"]}),e.jsx("div",{className:"h-px flex-1 bg-red-500/20"})]}),e.jsxs("div",{className:"space-y-2",children:[I.map(i=>e.jsx("div",{className:"hidden md:block",children:e.jsx(l,{appointment:i})},i.id)),I.map(i=>e.jsx("div",{className:"md:hidden",children:e.jsx(P,{appointment:i})},i.id))]})]})]})})]})},Us=({tasks:t,services:s,selectedDate:a,onDateChange:r,onUpdateStatus:n,onViewDetails:o})=>{const{t:d}=_("admin"),{t:x}=_("common"),p=c=>{if(c.nameKey){const u=x(`services_data.${c.nameKey}.name`,{defaultValue:""});if(u&&u!==`services_data.${c.nameKey}.name`)return u}return c.name},h=c=>c.map(u=>{const k=s.find(b=>b.id===u);return k?p(k):null}).filter(Boolean).join(", ");return e.jsxs("div",{className:"h-full flex flex-col bg-dark-800 border-l border-white/10 rtl:border-l-0 rtl:border-r",children:[e.jsxs("div",{className:"p-3 border-b border-white/10",children:[e.jsx("h3",{className:"text-sm font-bold text-white mb-2",children:d("sidebar.title")}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-500 rtl:left-auto rtl:right-2"}),e.jsx("input",{type:"date",value:a,onChange:c=>r(c.target.value),className:"w-full bg-dark-900 border border-white/10 rounded pl-8 pr-2 py-1.5 text-xs text-white focus:border-gold-500/50 focus:ring-1 focus:ring-gold-500/50 outline-none cursor-pointer hover:border-white/20 transition-colors rtl:pl-2 rtl:pr-8"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-2 scrollbar-thin scrollbar-thumb-dark-600",children:t.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 text-[10px]",children:d("sidebar.noTasks")}):t.map(c=>e.jsxs("div",{className:`bg-dark-900 border rounded-md p-2 transition-all hover:border-gold-500/30 group ${c.status==="pending"?"border-yellow-500/30 shadow-[0_0_10px_-5px_rgba(234,179,8,0.2)]":c.status==="confirmed"?"border-green-500/20":"border-white/5 opacity-60"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"bg-dark-800 px-1 py-0.5 rounded text-[10px] font-bold text-white font-mono border border-white/10",children:c.appointmentTime}),c.status==="pending"&&e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-yellow-500 animate-pulse"})]}),e.jsxs("span",{className:"text-gold-500 text-[10px] font-bold",children:[c.totalPrice," RON"]})]}),e.jsxs("div",{className:"mb-1.5",children:[e.jsx("div",{className:"font-bold text-white text-xs truncate",children:c.fullName}),e.jsx("div",{className:"text-[10px] text-gray-500 truncate",children:h(c.services)})]}),e.jsxs("div",{className:"flex gap-1.5 mt-1.5 pt-1.5 border-t border-white/5",children:[e.jsx("button",{onClick:()=>o(c),className:"flex-1 py-0.5 bg-dark-800 hover:bg-dark-700 text-gray-400 hover:text-white text-[10px] font-medium rounded transition-colors",children:d("sidebar.details")}),c.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>n(c.id,"confirmed"),className:"flex-1 py-0.5 bg-green-500/10 hover:bg-green-500/20 text-green-400 text-[10px] font-medium rounded transition-colors",children:d("actions.confirm")}),e.jsx("button",{onClick:()=>n(c.id,"cancelled"),className:"p-0.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded transition-colors",title:d("actions.cancel"),children:e.jsx(oe,{className:"h-3 w-3"})})]})]})]},c.id))})]})};function Es(t,s){const a=Bs(s);return"formatToParts"in a?Rs(a,t):Ks(a,t)}const zs={year:0,month:1,day:2,hour:3,minute:4,second:5};function Rs(t,s){try{const a=t.formatToParts(s),r=[];for(let n=0;n<a.length;n++){const o=zs[a[n].type];o!==void 0&&(r[o]=parseInt(a[n].value,10))}return r}catch(a){if(a instanceof RangeError)return[NaN];throw a}}function Ks(t,s){const a=t.format(s),r=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(a);return[parseInt(r[3],10),parseInt(r[1],10),parseInt(r[2],10),parseInt(r[4],10),parseInt(r[5],10),parseInt(r[6],10)]}const ge={},$e=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),Zs=$e==="06/25/2014, 00:00:00"||$e==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";function Bs(t){return ge[t]||(ge[t]=Zs?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),ge[t]}function Ge(t,s,a,r,n,o,d){const x=new Date(0);return x.setUTCFullYear(t,s,a),x.setUTCHours(r,n,o,d),x}const Ie=36e5,Vs=6e4,fe={timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function Qe(t,s,a){if(!t)return 0;let r=fe.timezoneZ.exec(t);if(r)return 0;let n,o;if(r=fe.timezoneHH.exec(t),r)return n=parseInt(r[1],10),_e(n)?-(n*Ie):NaN;if(r=fe.timezoneHHMM.exec(t),r){n=parseInt(r[2],10);const d=parseInt(r[3],10);return _e(n,d)?(o=Math.abs(n)*Ie+d*Vs,r[1]==="+"?-o:o):NaN}if(Gs(t)){s=new Date(s||Date.now());const d=a?s:qs(s),x=je(d,t);return-(a?x:Xs(s,x,t))}return NaN}function qs(t){return Ge(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}function je(t,s){const a=Es(t,s),r=Ge(a[0],a[1]-1,a[2],a[3]%24,a[4],a[5],0).getTime();let n=t.getTime();const o=n%1e3;return n-=o>=0?o:1e3+o,r-n}function Xs(t,s,a){let n=t.getTime()-s;const o=je(new Date(n),a);if(s===o)return s;n-=o-s;const d=je(new Date(n),a);return o===d?o:Math.max(o,d)}function _e(t,s){return-23<=t&&t<=23&&(s==null||0<=s&&s<=59)}const Ae={};function Gs(t){if(Ae[t])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:t}),Ae[t]=!0,!0}catch{return!1}}function Pe(t){const s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return s.setUTCFullYear(t.getFullYear()),+t-+s}const Qs=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,pe=36e5,Ye=6e4,Js=2,A={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:Qs};function ea(t,s={}){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(t===null)return new Date(NaN);const a=s.additionalDigits==null?Js:Number(s.additionalDigits);if(a!==2&&a!==1&&a!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]")return new Date(t.getTime());if(typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]")return new Date(t);if(Object.prototype.toString.call(t)!=="[object String]")return new Date(NaN);const r=ta(t),{year:n,restDateString:o}=sa(r.date,a),d=aa(o,n);if(d===null||isNaN(d.getTime()))return new Date(NaN);if(d){const x=d.getTime();let p=0,h;if(r.time&&(p=ra(r.time),p===null||isNaN(p)))return new Date(NaN);if(r.timeZone||s.timeZone){if(h=Qe(r.timeZone||s.timeZone,new Date(x+p)),isNaN(h))return new Date(NaN)}else h=Pe(new Date(x+p)),h=Pe(new Date(x+p+h));return new Date(x+p+h)}else return new Date(NaN)}function ta(t){const s={};let a=A.dateTimePattern.exec(t),r;if(a?(s.date=a[1],r=a[3]):(a=A.datePattern.exec(t),a?(s.date=a[1],r=a[2]):(s.date=null,r=t)),r){const n=A.timeZone.exec(r);n?(s.time=r.replace(n[1],""),s.timeZone=n[1].trim()):s.time=r}return s}function sa(t,s){if(t){const a=A.YYY[s],r=A.YYYYY[s];let n=A.YYYY.exec(t)||r.exec(t);if(n){const o=n[1];return{year:parseInt(o,10),restDateString:t.slice(o.length)}}if(n=A.YY.exec(t)||a.exec(t),n){const o=n[1];return{year:parseInt(o,10)*100,restDateString:t.slice(o.length)}}}return{year:null}}function aa(t,s){if(s===null)return null;let a,r,n;if(!t||!t.length)return a=new Date(0),a.setUTCFullYear(s),a;let o=A.MM.exec(t);if(o)return a=new Date(0),r=parseInt(o[1],10)-1,He(s,r)?(a.setUTCFullYear(s,r),a):new Date(NaN);if(o=A.DDD.exec(t),o){a=new Date(0);const d=parseInt(o[1],10);return ia(s,d)?(a.setUTCFullYear(s,0,d),a):new Date(NaN)}if(o=A.MMDD.exec(t),o){a=new Date(0),r=parseInt(o[1],10)-1;const d=parseInt(o[2],10);return He(s,r,d)?(a.setUTCFullYear(s,r,d),a):new Date(NaN)}if(o=A.Www.exec(t),o)return n=parseInt(o[1],10)-1,Le(n)?Fe(s,n):new Date(NaN);if(o=A.WwwD.exec(t),o){n=parseInt(o[1],10)-1;const d=parseInt(o[2],10)-1;return Le(n,d)?Fe(s,n,d):new Date(NaN)}return null}function ra(t){let s,a,r=A.HH.exec(t);if(r)return s=parseFloat(r[1].replace(",",".")),be(s)?s%24*pe:NaN;if(r=A.HHMM.exec(t),r)return s=parseInt(r[1],10),a=parseFloat(r[2].replace(",",".")),be(s,a)?s%24*pe+a*Ye:NaN;if(r=A.HHMMSS.exec(t),r){s=parseInt(r[1],10),a=parseInt(r[2],10);const n=parseFloat(r[3].replace(",","."));return be(s,a,n)?s%24*pe+a*Ye+n*1e3:NaN}return null}function Fe(t,s,a){s=s||0,a=a||0;const r=new Date(0);r.setUTCFullYear(t,0,4);const n=r.getUTCDay()||7,o=s*7+a+1-n;return r.setUTCDate(r.getUTCDate()+o),r}const na=[31,28,31,30,31,30,31,31,30,31,30,31],la=[31,29,31,30,31,30,31,31,30,31,30,31];function Je(t){return t%400===0||t%4===0&&t%100!==0}function He(t,s,a){if(s<0||s>11)return!1;if(a!=null){if(a<1)return!1;const r=Je(t);if(r&&a>la[s]||!r&&a>na[s])return!1}return!0}function ia(t,s){if(s<1)return!1;const a=Je(t);return!(a&&s>366||!a&&s>365)}function Le(t,s){return!(t<0||t>52||s!=null&&(s<0||s>6))}function be(t,s,a){return!(t<0||t>=25||s!=null&&(s<0||s>=60)||a!=null&&(a<0||a>=60))}function oa(t,s,a){t=ea(t,a);const r=Qe(s,t,!0),n=new Date(t.getTime()-r),o=new Date(0);return o.setFullYear(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()),o.setHours(n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds()),o}const da=()=>{const{t,i18n:s}=_("admin"),a=s.language==="ar"?te:ee,[r,n]=g.useState(new Date),[o,d]=g.useState({startTime:"10:00",endTime:"20:00",slotDuration:60,isClosed:!1}),[x,p]=g.useState(!1),[h,c]=g.useState(null),[u,k]=g.useState({openTime:"10:00",closeTime:"20:00",slotDuration:60,defaultClosedDays:[0]});g.useEffect(()=>{(async()=>{try{const f=await S.get("/config");k({openTime:f.data.openTime,closeTime:f.data.closeTime,slotDuration:f.data.slotDuration,defaultClosedDays:f.data.defaultClosedDays||[0]}),d(N=>({...N,startTime:f.data.openTime,endTime:f.data.closeTime,slotDuration:f.data.slotDuration}))}catch(f){console.error("Failed to fetch salon config:",f)}})()},[]),g.useEffect(()=>{r&&b()},[r]);const b=async()=>{try{const m=M(r,"yyyy-MM-dd"),f=await S.get(`/availability/${m}`);d(f.data)}catch(m){console.error("Failed to fetch availability:",m)}},v=async()=>{p(!0),c(null);try{const m=M(r,"yyyy-MM-dd");await S.post("/availability",{date:m,...o}),c({type:"success",text:t("availability.saveSuccess")}),setTimeout(()=>c(null),3e3)}catch{c({type:"error",text:t("availability.saveError")})}finally{p(!1)}},y=async()=>{if(confirm(t("availability.resetConfirm"))){p(!0);try{const m=M(r,"yyyy-MM-dd");await S.delete(`/availability/${m}`);const f=u.timeZone||"Europe/Bucharest",w=oa(r,f).getDay(),T=u.defaultClosedDays.includes(w);d({startTime:u.openTime,endTime:u.closeTime,slotDuration:u.slotDuration,isClosed:T}),c({type:"success",text:t("availability.resetSuccess")}),setTimeout(()=>c(null),3e3)}catch{c({type:"error",text:t("availability.resetError")})}finally{p(!1)}}};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-white mb-1",children:t("availability.title")}),e.jsx("p",{className:"text-gray-400 text-sm",children:t("availability.subtitle")})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-dark-800 to-dark-700 rounded-xl md:rounded-2xl p-4 md:p-8 border border-white/10 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-4 md:mb-6",children:[e.jsx("div",{className:"bg-gold-500/10 p-2 md:p-3 rounded-lg md:rounded-xl",children:e.jsx(K,{className:"h-5 w-5 md:h-6 md:w-6 text-gold-500"})}),e.jsx("h3",{className:"text-lg md:text-xl font-bold text-white",children:t("availability.selectDate")})]}),e.jsx("div",{className:"bg-dark-900/50 p-2 md:p-6 rounded-lg md:rounded-xl border border-white/5",children:e.jsx("div",{className:"flex justify-center overflow-x-auto scrollbar-hide",children:e.jsx(Ke,{mode:"single",selected:r,onSelect:m=>m&&n(m),locale:a,modifiersClassNames:{selected:"bg-gold-500 !text-dark-900 font-bold hover:bg-gold-400",today:"text-gold-500 font-bold"},className:"text-white rdp-custom",dir:s.language==="ar"?"rtl":"ltr",styles:{caption:{padding:"0.5rem"},caption_label:{fontSize:"0.9rem",fontWeight:"bold"},head_cell:{fontSize:"0.7rem",color:"#9ca3af",width:"2.5rem"},cell:{width:"2.5rem",height:"2.5rem"},day:{width:"2.2rem",height:"2.2rem",borderRadius:"0.5rem"},nav_button:{width:"1.75rem",height:"1.75rem"}}})})}),e.jsxs("div",{className:"mt-4 md:mt-6 p-3 md:p-4 bg-dark-900/80 rounded-lg md:rounded-xl border border-white/10 flex items-center justify-between",children:[e.jsxs("span",{className:"text-gray-400 text-sm",children:[t("availability.selectedDate"),":"]}),e.jsx("span",{className:"text-gold-500 font-bold text-sm md:text-lg",children:M(r,"dd MMMM yyyy",{locale:a})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-dark-800 to-dark-700 rounded-xl md:rounded-2xl p-4 md:p-8 border border-white/10 shadow-xl flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-4 md:mb-6",children:[e.jsx("div",{className:"bg-gold-500/10 p-2 md:p-3 rounded-lg md:rounded-xl",children:e.jsx(O,{className:"h-5 w-5 md:h-6 md:w-6 text-gold-500"})}),e.jsx("h3",{className:"text-lg md:text-xl font-bold text-white",children:t("availability.configTitle")})]}),e.jsxs("div",{className:"space-y-6 flex-1",children:[e.jsxs("div",{className:`flex items-center justify-between p-5 rounded-xl border transition-all duration-300 ${o.isClosed?"bg-red-500/10 border-red-500/30":"bg-dark-900/50 border-white/10"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[o.isClosed?e.jsx(jt,{className:"h-6 w-6 text-red-500"}):e.jsx(Me,{className:"h-6 w-6 text-green-500"}),e.jsxs("div",{children:[e.jsx("span",{className:`font-bold block ${o.isClosed?"text-red-400":"text-white"}`,children:o.isClosed?t("availability.closed"):t("availability.open")}),e.jsx("span",{className:"text-xs text-gray-400",children:o.isClosed?t("availability.closedDesc"):t("availability.openDesc")})]})]}),e.jsx("button",{onClick:()=>d({...o,isClosed:!o.isClosed}),className:`relative w-14 h-7 rounded-full transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-dark-900 ${o.isClosed?"bg-red-500 focus:ring-red-500":"bg-green-500 focus:ring-green-500"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-5 h-5 bg-white rounded-full shadow-md transition-transform duration-300 ${o.isClosed?"transform translate-x-7":""} rtl:right-1 rtl:left-auto rtl:translate-x-[-1.75rem]`})})]}),!o.isClosed&&e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:t("availability.startTime")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"time",value:o.startTime,onChange:m=>d({...o,startTime:m.target.value}),className:"w-full h-12 bg-dark-900 border border-white/10 rounded-xl px-3 pl-10 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none transition-all rtl:pl-3 rtl:pr-10 appearance-none"}),e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 rtl:left-auto rtl:right-3 pointer-events-none"})]})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:t("availability.endTime")}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"time",value:o.endTime,onChange:m=>d({...o,endTime:m.target.value}),className:"w-full h-12 bg-dark-900 border border-white/10 rounded-xl px-3 pl-10 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none transition-all rtl:pl-3 rtl:pr-10 appearance-none"}),e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500 rtl:left-auto rtl:right-3 pointer-events-none"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-400",children:t("availability.slotDuration")}),e.jsxs("select",{value:o.slotDuration,onChange:m=>d({...o,slotDuration:Number(m.target.value)}),className:"w-full h-12 bg-dark-900 border border-white/10 rounded-xl px-3 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsxs("option",{value:15,children:["15 ",t("availability.minutes")]}),e.jsxs("option",{value:30,children:["30 ",t("availability.minutes")]}),e.jsxs("option",{value:45,children:["45 ",t("availability.minutes")]}),e.jsxs("option",{value:60,children:["60 ",t("availability.minutes")]})]})]})]}),h&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center gap-3 animate-fade-in ${h.type==="success"?"bg-green-500/10 border border-green-500/20 text-green-400":"bg-red-500/10 border border-red-500/20 text-red-400"}`,children:[h.type==="success"?e.jsx(Me,{className:"h-5 w-5"}):e.jsx(ot,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:h.text})]}),e.jsxs("div",{className:"flex gap-3 pt-4 mt-auto",children:[e.jsxs("button",{onClick:v,disabled:x,className:"flex-1 flex items-center justify-center gap-2 bg-gold-500 text-dark-900 py-3.5 rounded-xl font-bold hover:bg-gold-400 transition-all transform hover:scale-[1.02] disabled:opacity-50 disabled:hover:scale-100 shadow-lg shadow-gold-500/20",children:[x?e.jsx("span",{className:"animate-spin",children:"⌛"}):e.jsx(Ve,{className:"h-5 w-5"}),t(x?"availability.saving":"availability.saveChanges")]}),e.jsx("button",{onClick:y,disabled:x,className:"px-5 flex items-center justify-center gap-2 bg-dark-800 text-gray-400 border border-white/10 py-3.5 rounded-xl font-medium hover:bg-dark-700 hover:text-white transition-all disabled:opacity-50",title:t("availability.reset"),children:e.jsx(Ot,{className:"h-5 w-5"})})]})]})]})]})]})},ca=({isOpen:t,onClose:s,onSuccess:a,services:r})=>{const{t:n,i18n:o}=_("admin"),d=o.language==="ar"?te:ee,[x,p]=g.useState(!1),[h,c]=g.useState([]),[u,k]=g.useState(new Date),[b,v]=g.useState(""),[y,m]=g.useState([]),[f,N]=g.useState({fullName:"",phone:"0791125555",email:"",message:"",source:"phone",status:"confirmed"}),[w,T]=g.useState({maxBookingDays:7});g.useEffect(()=>{(async()=>{try{const i=await S.get("/config");T(i.data)}catch(i){console.error("Failed to fetch salon config:",i)}})()},[]),g.useEffect(()=>{t&&(N({fullName:"",phone:"0791125555",email:"",message:"",source:"phone",status:"confirmed"}),c([]),k(new Date),v(""))},[t]),g.useEffect(()=>{if(!u){m([]);return}(async()=>{try{const i=M(u,"yyyy-MM-dd"),D=await S.get(`/availability/${i}`),{startTime:Y,endTime:F,slotDuration:W,isClosed:Z,bookedSlots:B}=D.data;if(Z){m([]);return}const se=[],[de,ae]=Y.split(":").map(Number),[ce,z]=F.split(":").map(Number);let L=de*60+ae;const R=ce*60+z,H=new Date,re=M(u,"yyyy-MM-dd")===M(H,"yyyy-MM-dd"),V=H.getHours()*60+H.getMinutes();for(;L<R;){if(re&&L<V){L+=W;continue}const me=Math.floor(L/60),xe=L%60,ne=`${String(me).padStart(2,"0")}:${String(xe).padStart(2,"0")}`;(!B||!B.includes(ne))&&se.push(ne),L+=W}m(se)}catch(i){console.error("Failed to fetch availability",i),m([])}})()},[u]);const I=l=>{c(i=>i.includes(l)?i.filter(D=>D!==l):[...i,l])},C=()=>r.filter(l=>h.includes(l.id)).reduce((l,i)=>l+i.price,0),P=async l=>{if(l.preventDefault(),!u||!b||h.length===0){alert(n("modal.fillRequired"));return}p(!0);try{await S.post("/appointments",{...f,appointmentDate:M(u,"yyyy-MM-dd"),appointmentTime:b,services:h,totalPrice:C()}),a(),s()}catch(i){console.error("Booking failed",i),alert(n("modal.createError"))}finally{p(!1)}};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm overflow-y-auto",children:e.jsxs("div",{className:"bg-dark-800 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto border border-white/10 shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-800 p-6 border-b border-white/10 flex justify-between items-center z-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:n("modal.createTitle")}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(oe,{className:"h-6 w-6"})})]}),e.jsx("form",{onSubmit:P,className:"p-6 space-y-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gold-500 flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"})," ",n("modal.clientDetails")]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:[n("modal.fullName")," *"]}),e.jsx("input",{type:"text",required:!0,value:f.fullName,onChange:l=>N({...f,fullName:l.target.value}),className:"w-full bg-dark-900 border border-white/10 rounded-lg p-3 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none rtl:text-right",placeholder:n("modal.fullName")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-400 mb-1 flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"})," ",n("modal.phone")]}),e.jsx(nt,{value:f.phone,onChange:l=>N({...f,phone:l})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gold-500 flex items-center gap-2",children:[e.jsx(lt,{className:"h-5 w-5"})," ",n("modal.services")," *"]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-[400px] overflow-y-auto pr-2",children:r.map(l=>e.jsxs("div",{onClick:()=>I(l.id),className:`p-3 rounded-lg border cursor-pointer transition-all flex justify-between items-center ${h.includes(l.id)?"bg-gold-500/10 border-gold-500":"bg-dark-900 border-white/10 hover:border-gold-500/50"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${h.includes(l.id)?"text-gold-500":"text-white"}`,children:l.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[l.duration," min"]})]}),e.jsxs("p",{className:"font-bold text-white",children:[l.price," RON"]})]},l.id))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gold-500 flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"})," ",n("modal.dateAndTime")," *"]}),e.jsx("div",{className:"bg-dark-900 p-4 rounded-xl border border-white/10 flex justify-center",children:e.jsx(Ke,{mode:"single",selected:u,onSelect:k,locale:d,disabled:[{before:new Date},{after:new Date(new Date().setDate(new Date().getDate()+w.maxBookingDays))}],modifiersClassNames:{selected:"bg-gold-500 !text-dark-900 font-bold hover:bg-gold-400",today:"text-gold-500 font-bold"},className:"text-white",dir:o.language==="ar"?"rtl":"ltr"})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-medium mb-3 flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-gold-500"})," ",n("modal.availableHours")]}),u?y.length===0?e.jsx("p",{className:"text-red-400 text-sm",children:n("modal.noSlots")}):e.jsx("div",{className:"grid grid-cols-4 gap-2 max-h-60 overflow-y-auto pr-2",children:y.map(l=>e.jsx("button",{type:"button",onClick:()=>v(l),className:`p-2 rounded text-sm font-medium transition-colors ${b===l?"bg-gold-500 text-dark-900":"bg-dark-900 text-gray-300 hover:bg-dark-700 border border-white/10"}`,children:l},l))}):e.jsx("p",{className:"text-gray-400 text-sm",children:n("modal.selectDateFirst")})]}),e.jsxs("div",{className:"bg-dark-900 p-4 rounded-xl border border-white/10 mt-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("span",{className:"text-gray-400",children:[n("modal.total"),":"]}),e.jsxs("span",{className:"text-2xl font-bold text-gold-500",children:[C()," RON"]})]}),e.jsx("button",{type:"submit",disabled:x||!u||!b||h.length===0,className:"w-full bg-gold-500 text-dark-900 py-3 rounded-lg font-bold hover:bg-gold-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:x?e.jsx(it,{className:"h-5 w-5 animate-spin"}):n("modal.createButton")})]})]})]})})]})}):null},ma=({appointment:t,services:s,onClose:a,onUpdateStatus:r})=>{const{t:n,i18n:o}=_("admin"),{t:d}=_("common"),x=o.language==="ar"?te:ee;if(!t)return null;const p=m=>{if(m.nameKey){const f=d(`services_data.${m.nameKey}.name`,{defaultValue:""});if(f&&f!==`services_data.${m.nameKey}.name`)return f}return m.name},h=m=>m.map(f=>{const N=s.find(w=>w.id===f);return N?p(N):null}).filter(Boolean).join(", "),c=(m="web")=>{switch(m){case"web":return e.jsx(ke,{className:"h-4 w-4 text-blue-400"});case"phone":return e.jsx(J,{className:"h-4 w-4 text-green-400"});case"whatsapp":return e.jsx(Q,{className:"h-4 w-4 text-green-500"});case"walk_in":return e.jsx(ct,{className:"h-4 w-4 text-orange-400"});case"instagram":return e.jsx(Te,{className:"h-4 w-4 text-pink-500"});default:return e.jsx(ie,{className:"h-4 w-4 text-gray-400"})}},u=(m="web")=>{switch(m){case"web":return"Website";case"phone":return"Telefon";case"whatsapp":return"WhatsApp";case"walk_in":return"Walk-in";case"instagram":return"Instagram";case"facebook":return"Facebook";default:return m}},k=m=>{switch(m){case"confirmed":return"bg-green-500/20 text-green-400 border-green-500/30";case"pending":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"cancelled":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},b=`✅ Programare confirmată!

Bună ${t.fullName},

Programarea ta la Kings Barber este confirmată pentru ${M(new Date(t.appointmentDate),"dd/MM/yyyy")} la ${t.appointmentTime}.

Ne vedem curând!

Cu stimă ✂️
Kings Barber`,v=`❌ Programare refuzată!

Bună ${t.fullName},

Din păcate, programarea ta la Kings Barber, programată pentru ${M(new Date(t.appointmentDate),"dd/MM/yyyy")} la ${t.appointmentTime}, nu poate fi confirmată și a fost refuzată.

Te rugăm să alegi o altă dată sau oră care ți se potrivește.

Cu stimă ✂️
Kings Barber`,y=m=>{let f="";if(m==="confirmed"?f=b:m==="cancelled"&&(f=v),f){const w=`https://wa.me/${t.phone.replace(/[\s+]/g,"")}?text=${encodeURIComponent(f)}`;window.open(w,"_blank")}r(t.id,m)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex justify-end rtl:justify-start",onClick:a,children:e.jsxs("div",{className:"bg-dark-800 w-full max-w-md h-full overflow-y-auto border-l border-white/10 rtl:border-l-0 rtl:border-r",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-white/10 p-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:n("drawer.title")}),e.jsx("button",{onClick:a,className:"p-1 hover:bg-white/10 rounded transition-colors",children:e.jsx(oe,{className:"h-5 w-5 text-gray-400"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2 block",children:n("drawer.status")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y("pending"),disabled:t.status!=="pending",className:`flex-1 px-3 py-2 rounded text-xs font-medium border transition-colors ${t.status==="pending"?k("pending"):"bg-dark-700 text-gray-400 border-white/10"} ${t.status!=="pending"?"opacity-30 cursor-not-allowed":"hover:bg-dark-600"}`,children:n("filters.pending")}),e.jsxs("button",{onClick:()=>y("confirmed"),className:`flex-[1.5] px-3 py-2 rounded text-xs font-medium border transition-colors flex items-center justify-center gap-1.5 ${t.status==="confirmed"?k("confirmed"):"bg-dark-700 text-gray-400 border-white/10 hover:bg-green-500/10 hover:text-green-400 hover:border-green-500/30"}`,title:"Confirm & Send WhatsApp",children:[e.jsx(Q,{className:"h-3.5 w-3.5"}),n("filters.confirmed")]}),e.jsxs("button",{onClick:()=>y("cancelled"),className:`flex-[1.5] px-3 py-2 rounded text-xs font-medium border transition-colors flex items-center justify-center gap-1.5 ${t.status==="cancelled"?k("cancelled"):"bg-dark-700 text-gray-400 border-white/10 hover:bg-red-500/10 hover:text-red-400 hover:border-red-500/30"}`,title:"Cancel & Send WhatsApp",children:[e.jsx(Q,{className:"h-3.5 w-3.5"}),n("filters.cancelled")]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-dark-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-1",children:[e.jsx(K,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:n("drawer.date")})]}),e.jsx("p",{className:"text-sm font-medium text-white",children:M(new Date(t.appointmentDate),"dd MMM yyyy",{locale:x})})]}),e.jsxs("div",{className:"bg-dark-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 mb-1",children:[e.jsx(O,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:n("drawer.time")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:t.appointmentTime}),t.totalDuration&&e.jsxs("span",{className:"text-xs text-gray-400 bg-dark-600 px-2 py-0.5 rounded",children:[t.totalDuration," min"]})]})]})]}),e.jsxs("div",{className:"bg-dark-700 rounded-lg p-3 space-y-2",children:[e.jsx("h3",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:n("drawer.client")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 text-gold-500"}),e.jsx("span",{className:"text-sm text-white",children:t.fullName})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-gold-500"}),e.jsx("a",{href:`tel:${t.phone}`,className:"text-sm text-blue-400 hover:underline dir-ltr",children:t.phone})]}),t.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"h-4 w-4 text-gold-500"}),e.jsx("a",{href:`mailto:${t.email}`,className:"text-sm text-blue-400 hover:underline",children:t.email})]})]}),e.jsxs("div",{className:"bg-dark-700 rounded-lg p-3",children:[e.jsx("h3",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:n("drawer.services")}),e.jsx("p",{className:"text-sm text-white",children:h(t.services)})]}),e.jsx("div",{className:"bg-dark-700 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(kt,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs",children:n("drawer.total")})]}),e.jsxs("span",{className:"text-lg font-bold text-gold-500",children:[t.totalPrice," RON"]})]})}),e.jsxs("div",{className:"bg-dark-700 rounded-lg p-3",children:[e.jsx("h3",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:n("drawer.source")}),e.jsxs("div",{className:"flex items-center gap-2",children:[c(t.source),e.jsx("span",{className:"text-sm text-white",children:u(t.source)})]})]}),t.message&&e.jsxs("div",{className:"bg-dark-700 rounded-lg p-3",children:[e.jsx("h3",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:n("drawer.message")}),e.jsx("p",{className:"text-sm text-gray-300",children:t.message})]}),e.jsxs("div",{className:"text-xs text-gray-500 text-center pt-2 border-t border-white/10",children:[n("drawer.created"),": ",M(new Date(t.createdAt),"dd MMM yyyy, HH:mm",{locale:x})]})]})]})})},Oe=[{value:"scissors",label:"Scissors",Icon:ve},{value:"sparkles",label:"Sparkles",Icon:mt},{value:"hand",label:"Hand",Icon:xt},{value:"droplet",label:"Droplet",Icon:ut},{value:"user",label:"User",Icon:ie},{value:"wand",label:"Wand",Icon:ht}],xa=()=>{const{t}=_("admin"),{t:s}=_("common"),[a,r]=g.useState([]),[n,o]=g.useState(!0),[d,x]=g.useState(null),[p,h]=g.useState(!1),[c,u]=g.useState({name:"",nameKey:"",price:0,duration:30,description:"",descriptionKey:"",icon:"scissors",isActive:!0,sortOrder:0}),[k,b]=g.useState(null),v=async()=>{try{o(!0);const l=await S.get("/services/all");r(l.data)}catch(l){console.error("Failed to fetch services:",l)}finally{o(!1)}};g.useEffect(()=>{v()},[]);const y=(l,i)=>{b({type:l,text:i}),setTimeout(()=>b(null),3e3)},m=()=>{h(!0),x(null),u({name:"",nameKey:"",price:0,duration:30,description:"",descriptionKey:"",icon:"scissors",isActive:!0,sortOrder:a.length})},f=l=>{x(l),h(!1),u({name:l.name,nameKey:l.nameKey||"",price:l.price,duration:l.duration,description:l.description||"",descriptionKey:l.descriptionKey||"",icon:l.icon||"scissors",isActive:l.isActive!==!1,sortOrder:l.sortOrder||0})},N=()=>{x(null),h(!1),u({name:"",nameKey:"",price:0,duration:30,description:"",descriptionKey:"",icon:"scissors",isActive:!0,sortOrder:0})},w=async()=>{try{p?(await S.post("/services",c),y("success",t("services.saveSuccess"))):d&&(await S.put(`/services/${d.id}`,c),y("success",t("services.saveSuccess"))),v(),N()}catch(l){console.error("Failed to save service:",l),y("error",t("services.saveError"))}},T=async l=>{if(confirm(t("services.deleteConfirm")))try{await S.delete(`/services/${l}`),y("success",t("services.deleteSuccess")),v()}catch(i){console.error("Failed to delete service:",i),y("error",t("services.deleteError"))}},I=async l=>{try{await S.put(`/services/${l.id}`,{isActive:!l.isActive}),v()}catch(i){console.error("Failed to toggle active:",i)}},C=l=>{const i=Oe.find(D=>D.value===l);return i?i.Icon:ve},P=l=>{if(l.nameKey){const i=s(`services_data.${l.nameKey}.name`,{defaultValue:""});if(i&&i!==`services_data.${l.nameKey}.name`)return i}return l.name};return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-gold-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-white",children:t("services.title")}),e.jsx("p",{className:"text-gray-400 text-xs md:text-sm",children:t("services.subtitle")})]}),e.jsxs("button",{onClick:m,className:"inline-flex items-center justify-center gap-2 bg-gold-500 text-dark-900 px-3 md:px-4 py-2 rounded-lg text-sm font-medium hover:bg-gold-400 transition-colors",children:[e.jsx(Be,{className:"h-4 w-4 md:h-5 md:w-5 flex-shrink-0"}),e.jsx("span",{children:t("services.addNew")})]})]}),k&&e.jsx("div",{className:`p-4 rounded-lg ${k.type==="success"?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:k.text}),(p||d)&&e.jsxs("div",{className:"bg-dark-800 border border-white/10 rounded-xl p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:t(p?"services.addNew":"services.editService")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:[t("services.name")," *"]}),e.jsx("input",{type:"text",value:c.name,onChange:l=>u({...c,name:l.target.value}),className:"w-full bg-dark-900 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-gold-500 outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:t("services.nameKey")}),e.jsx("input",{type:"text",value:c.nameKey||"",onChange:l=>u({...c,nameKey:l.target.value}),placeholder:"e.g. tuns, barba",className:"w-full bg-dark-900 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-gold-500 outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:[t("services.price")," *"]}),e.jsx("input",{type:"number",value:c.price,onChange:l=>u({...c,price:parseInt(l.target.value)||0}),className:"w-full bg-dark-900 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-gold-500 outline-none",min:0,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-400 mb-1",children:[t("services.duration")," *"]}),e.jsx("input",{type:"number",value:c.duration,onChange:l=>u({...c,duration:parseInt(l.target.value)||0}),className:"w-full bg-dark-900 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-gold-500 outline-none",min:5,step:5,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:t("services.icon")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Oe.map(l=>{const i=l.Icon;return e.jsx("button",{type:"button",onClick:()=>u({...c,icon:l.value}),className:`p-2 rounded-lg border transition-colors inline-flex items-center justify-center ${c.icon===l.value?"bg-gold-500 text-dark-900 border-gold-500":"bg-dark-700 text-gray-400 border-white/10 hover:border-gold-500/50"}`,title:t(`services.icons.${l.value}`),children:e.jsx(i,{className:"h-5 w-5 flex-shrink-0"})},l.value)})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"block text-sm text-gray-400",children:t("services.isActive")}),e.jsx("button",{type:"button",onClick:()=>u({...c,isActive:!c.isActive}),className:`w-12 h-6 rounded-full transition-colors ${c.isActive?"bg-green-500":"bg-gray-600"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full bg-white transform transition-transform ${c.isActive?"translate-x-6":"translate-x-0.5"}`})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:t("services.description")}),e.jsx("textarea",{value:c.description||"",onChange:l=>u({...c,description:l.target.value}),className:"w-full bg-dark-900 border border-white/10 rounded-lg px-3 py-2 text-white focus:border-gold-500 outline-none h-20 resize-none"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs("button",{onClick:w,disabled:!c.name||c.price===void 0||c.duration===void 0,className:"flex items-center gap-2 bg-gold-500 text-dark-900 px-4 py-2 rounded-lg font-medium hover:bg-gold-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Ve,{className:"h-4 w-4"}),t("services.save")]}),e.jsxs("button",{onClick:N,className:"flex items-center gap-2 bg-dark-700 text-gray-300 px-4 py-2 rounded-lg font-medium hover:bg-dark-600 transition-colors",children:[e.jsx(oe,{className:"h-4 w-4"}),t("services.cancel")]})]})]}),a.length===0?e.jsx("div",{className:"text-center py-12 text-gray-400",children:e.jsx("p",{children:t("services.noServices")})}):e.jsx("div",{className:"space-y-3",children:a.map(l=>{const i=C(l.icon),D=P(l);return e.jsxs("div",{className:`bg-dark-800 border rounded-xl p-3 md:p-4 ${l.isActive?"border-white/10":"border-red-500/30 opacity-60"}`,children:[e.jsxs("div",{className:"md:hidden",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${l.isActive?"bg-gold-500 text-dark-900":"bg-dark-700 text-gray-400"}`,children:e.jsx(i,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium text-sm",children:D}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:e.jsxs("span",{children:[l.duration," min"]})})]})]}),e.jsxs("div",{className:"text-gold-500 font-bold text-sm",children:[l.price," RON"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>I(l),className:`px-2 py-1 text-xs rounded ${l.isActive?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:l.isActive?t("services.active"):t("services.inactive")}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>f(l),className:"p-2 text-gray-400 active:text-white active:bg-dark-700 rounded-lg",children:e.jsx(Se,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T(l.id),className:"p-2 text-gray-400 active:text-red-400 active:bg-red-500/10 rounded-lg",children:e.jsx(Ce,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[e.jsx("div",{className:"text-gray-500 cursor-grab",children:e.jsx(St,{className:"h-5 w-5"})}),e.jsx("div",{className:`p-2 rounded-lg ${l.isActive?"bg-gold-500 text-dark-900":"bg-dark-700 text-gray-400"}`,children:e.jsx(i,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-medium",children:D}),l.nameKey&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Key: ",l.nameKey]}),l.description&&e.jsx("p",{className:"text-sm text-gray-400 truncate max-w-md",children:l.description})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsxs("span",{children:[l.duration," min"]})]}),e.jsxs("div",{className:"text-gold-500 font-bold text-lg min-w-[80px] text-right",children:[l.price," RON"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>I(l),className:`px-2 py-1 text-xs rounded ${l.isActive?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:l.isActive?t("services.active"):t("services.inactive")}),e.jsx("button",{onClick:()=>f(l),className:"p-2 text-gray-400 hover:text-white hover:bg-dark-700 rounded-lg transition-colors",children:e.jsx(Se,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T(l.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx(Ce,{className:"h-4 w-4"})})]})]})]},l.id)})})]})},ka=()=>{const{t}=_("admin"),s=tt(),[a,r]=g.useState([]),[n,o]=g.useState([]),[d,x]=g.useState([]),[p,h]=g.useState([]),[c,u]=g.useState(!0),[k,b]=g.useState(!1),[v,y]=g.useState(null),[m,f]=g.useState(!1),[N,w]=g.useState("today"),[T,I]=g.useState(""),[C,P]=g.useState("all"),[l,i]=g.useState(""),[D,Y]=g.useState(M(new Date,"yyyy-MM-dd")),[F,W]=g.useState(M(new Date,"yyyy-MM-dd")||"2025-12-06"),[Z,B]=g.useState(1),[se,de]=g.useState(1),[ae,ce]=g.useState(0),z=g.useCallback(async()=>{try{console.log("Fetching appointments with params:",{currentPage:Z,statusFilter:C,dateFilter:l}),u(!0);const j=new URLSearchParams({page:Z.toString(),limit:"12",...C!=="all"&&{status:C},...l&&{date:l}}),U=await S.get(`/appointments?${j}`);console.log("Appointments response:",U.data),r(U.data.data||[]),de(U.data.pagination?.totalPages||1),ce(U.data.pagination?.totalItems||0)}catch(j){console.error("Failed to fetch appointments:",j),r([])}finally{u(!1)}},[Z,C,l]),L=g.useCallback(async()=>{try{const j=await S.get("/services");x(j.data)}catch(j){console.error("Failed to fetch services:",j)}},[]),R=g.useCallback(async()=>{try{console.log("Fetching tasks for date:",D);const j=await S.get(`/appointments/tasks?date=${D}`);console.log("Tasks response:",j.data),h(j.data.tasks||[])}catch(j){console.error("Failed to fetch tasks:",j),h([])}},[D]),H=g.useCallback(async()=>{try{console.log("Fetching today appointments for:",F),b(!0);const j=await S.get(`/appointments?date=${F}&limit=100`);console.log("Today appointments response:",j.data),o(j.data.data||[])}catch(j){console.error("Failed to fetch today appointments:",j),o([])}finally{b(!1)}},[F]),re=g.useCallback(async()=>{try{await S.get("/auth/me"),z(),L(),H()}catch(j){console.error("Auth check failed",j)}},[z,L,H]);g.useEffect(()=>{re()},[re]),g.useEffect(()=>{R()},[R]),g.useEffect(()=>{H()},[H]);const V=async(j,U)=>{try{await S.put(`/appointments/${j}/status`,{status:U}),z(),R(),H(),v&&v.id===j&&y({...v,status:U})}catch(et){console.error("Failed to update status:",et),alert(t("messages.updateError"))}},me=async()=>{try{await S.post("/auth/logout"),s("/admin/login")}catch(j){console.error("Logout failed",j),s("/admin/login")}},xe=a.filter(j=>T===""||j.fullName.toLowerCase().includes(T.toLowerCase())||j.phone.includes(T)),ne={total:ae,pending:a.filter(j=>j.status==="pending").length,confirmed:a.filter(j=>j.status==="confirmed").length};return e.jsxs(Hs,{header:e.jsx(Ls,{activeView:N,setActiveView:w,searchQuery:T,setSearchQuery:I,statusFilter:C,setStatusFilter:j=>{P(j),B(1)},dateFilter:l,setDateFilter:j=>{i(j),B(1)},onRefresh:()=>{z(),R(),H()},onLogout:me,onNewAppointment:()=>f(!0),stats:ne}),sidebar:e.jsx(Us,{tasks:p,services:d,selectedDate:D,onDateChange:Y,onUpdateStatus:V,onViewDetails:y}),children:[N==="availability"?e.jsx(da,{}):N==="services"?e.jsx(xa,{}):N==="today"?e.jsx(Ws,{appointments:n,services:d,loading:k,selectedDate:F,onDateChange:W,onStatusUpdate:V,onViewDetails:y}):e.jsx(Os,{appointments:xe,services:d,loading:c,currentPage:Z,totalPages:se,totalItems:ae,onPageChange:B,onStatusUpdate:V,onViewDetails:y}),m&&e.jsx(ca,{isOpen:m,onClose:()=>f(!1),onSuccess:()=>{z(),R(),H(),f(!1)},services:d}),v&&e.jsx(ma,{appointment:v,services:d,onClose:()=>y(null),onUpdateStatus:V})]})};export{ka as default};
