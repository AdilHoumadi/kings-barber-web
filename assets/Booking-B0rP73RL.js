import{r as l,j as e,b as le,u as J,C as W,a as P}from"./index-DmkQlbd4.js";import{S as ne}from"./ServiceCard-am3ANUR7.js";import{r as re,e as ie,C as ce,D as de,a as Y,f as h,L as me}from"./style-LwoVGtBY.js";import{S as ge}from"./SEO-ta2gtUTW.js";import"./wand-CFG4xx63.js";import"./user-DhU2i25x.js";import"./clock-C6MogU3E.js";const $=[{code:"+40",flag:"ðŸ‡·ðŸ‡´",name:"Romania",placeholder:"729 457 571"},{code:"+43",flag:"ðŸ‡¦ðŸ‡¹",name:"Austria",placeholder:"664 123456"},{code:"+32",flag:"ðŸ‡§ðŸ‡ª",name:"Belgium",placeholder:"470 12 34 56"},{code:"+359",flag:"ðŸ‡§ðŸ‡¬",name:"Bulgaria",placeholder:"48 123 456"},{code:"+385",flag:"ðŸ‡­ðŸ‡·",name:"Croatia",placeholder:"91 234 5678"},{code:"+357",flag:"ðŸ‡¨ðŸ‡¾",name:"Cyprus",placeholder:"96 123456"},{code:"+420",flag:"ðŸ‡¨ðŸ‡¿",name:"Czech Republic",placeholder:"601 123 456"},{code:"+45",flag:"ðŸ‡©ðŸ‡°",name:"Denmark",placeholder:"32 12 34 56"},{code:"+372",flag:"ðŸ‡ªðŸ‡ª",name:"Estonia",placeholder:"5123 4567"},{code:"+358",flag:"ðŸ‡«ðŸ‡®",name:"Finland",placeholder:"41 2345678"},{code:"+33",flag:"ðŸ‡«ðŸ‡·",name:"France",placeholder:"6 12 34 56 78"},{code:"+49",flag:"ðŸ‡©ðŸ‡ª",name:"Germany",placeholder:"151 23456789"},{code:"+30",flag:"ðŸ‡¬ðŸ‡·",name:"Greece",placeholder:"691 234 5678"},{code:"+36",flag:"ðŸ‡­ðŸ‡º",name:"Hungary",placeholder:"20 123 4567"},{code:"+353",flag:"ðŸ‡®ðŸ‡ª",name:"Ireland",placeholder:"85 012 3456"},{code:"+39",flag:"ðŸ‡®ðŸ‡¹",name:"Italy",placeholder:"312 345 6789"},{code:"+371",flag:"ðŸ‡±ðŸ‡»",name:"Latvia",placeholder:"21 234 567"},{code:"+370",flag:"ðŸ‡±ðŸ‡¹",name:"Lithuania",placeholder:"612 34567"},{code:"+352",flag:"ðŸ‡±ðŸ‡º",name:"Luxembourg",placeholder:"628 123 456"},{code:"+31",flag:"ðŸ‡³ðŸ‡±",name:"Netherlands",placeholder:"6 12345678"},{code:"+47",flag:"ðŸ‡³ðŸ‡´",name:"Norway",placeholder:"406 12 345"},{code:"+48",flag:"ðŸ‡µðŸ‡±",name:"Poland",placeholder:"512 345 678"},{code:"+351",flag:"ðŸ‡µðŸ‡¹",name:"Portugal",placeholder:"912 345 678"},{code:"+421",flag:"ðŸ‡¸ðŸ‡°",name:"Slovakia",placeholder:"912 123 456"},{code:"+386",flag:"ðŸ‡¸ðŸ‡®",name:"Slovenia",placeholder:"31 234 567"},{code:"+34",flag:"ðŸ‡ªðŸ‡¸",name:"Spain",placeholder:"612 34 56 78"},{code:"+46",flag:"ðŸ‡¸ðŸ‡ª",name:"Sweden",placeholder:"70 123 45 67"},{code:"+41",flag:"ðŸ‡¨ðŸ‡­",name:"Switzerland",placeholder:"78 123 45 67"},{code:"+44",flag:"ðŸ‡¬ðŸ‡§",name:"United Kingdom",placeholder:"7400 123456"}],he=({value:r,onChange:s,required:z=!1})=>{const[x,c]=l.useState("+40"),[u,f]=l.useState("");l.useEffect(()=>{if(r){const a=$.find(b=>r.startsWith(b.code));a?(c(a.code),f(r.substring(a.code.length))):f(r)}},[]);const E=a=>{c(a),s(a+u)},S=a=>{const b=a.replace(/[^\d\s]/g,"");f(b),s(x+b.replace(/\s/g,""))},L=$.find(a=>a.code===x)||$[0];return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:x,onChange:a=>E(a.target.value),className:"w-32 bg-dark-900 border border-white/10 rounded-lg p-3 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none transition-colors cursor-pointer",style:{appearance:"none",paddingRight:"2rem",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23fff' d='M6 9L1 4h10z'/%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center"},children:$.map(a=>e.jsxs("option",{value:a.code,children:[a.flag," ",a.code]},a.code))}),e.jsx("input",{type:"tel",required:z,value:u,onChange:a=>S(a.target.value),className:"flex-1 bg-dark-900 border border-white/10 rounded-lg p-3 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none transition-colors",placeholder:L.placeholder})]})},ue=()=>{const r=le(),{t:s,i18n:z}=J("common"),x=z.language==="ro"?re:ie,[c,u]=l.useState(1),[f,E]=l.useState(!1),[S,L]=l.useState([]),[a,b]=l.useState([]);l.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[c]);const[n,Q]=l.useState(),[d,G]=l.useState(""),[_,y]=l.useState([]),[i,B]=l.useState({fullName:"",phone:"",email:"",message:""}),[j,V]=l.useState({maxBookingDays:7,openTime:"10:00",closeTime:"20:00",slotDuration:60});l.useEffect(()=>{(async()=>{try{const o=await P.get("/config");V(o.data)}catch(o){console.error("Failed to fetch salon config:",o)}})()},[]),l.useEffect(()=>{(async()=>{try{const o=await P.get("/services");L(o.data)}catch(o){console.error("Failed to fetch services",o),L([{id:1,name:s("services_data.s1_name"),price:50,duration:30,description:s("services_data.s1_desc")},{id:2,name:s("services_data.s2_name"),price:80,duration:45,description:s("services_data.s2_desc")},{id:3,name:s("services_data.s3_name"),price:40,duration:20,description:s("services_data.s3_desc")}])}})()},[]),l.useEffect(()=>{if(!n){y([]);return}(async()=>{try{const o=h(n,"yyyy-MM-dd"),p=a.length>0?`?serviceIds=${a.join(",")}`:"",C=await P.get(`/availability/${o}${p}`),{isClosed:H,availableSlots:N,startTime:O,endTime:U,slotDuration:w,bookedSlots:I}=C.data;if(H){y([]);return}const A=j.timeZone||"Europe/Bucharest",M=new Date().toLocaleString("en-US",{timeZone:A}),R=new Date(M),m=h(n,"yyyy-MM-dd")===h(R,"yyyy-MM-dd"),v=R.getHours()*60+R.getMinutes();if(N&&N.length>0){const g=m?N.filter(D=>{const[T,Z]=D.split(":").map(Number);return T*60+Z>v}):N;y(g)}else{const g=[],[D,T]=O.split(":").map(Number),[Z,te]=U.split(":").map(Number);let k=D*60+T;const se=Z*60+te;for(;k<se;){if(m&&k<v){k+=w;continue}const ae=Math.floor(k/60),oe=k%60,K=`${String(ae).padStart(2,"0")}:${String(oe).padStart(2,"0")}`;(!I||!I.includes(K))&&g.push(K),k+=w}y(g)}}catch(o){console.error("Failed to fetch availability",o);const[p,C]=j.openTime.split(":").map(Number),[H,N]=j.closeTime.split(":").map(Number),O=p*60+C,U=H*60+N,w=[];for(let m=O;m<U;m+=j.slotDuration){const v=Math.floor(m/60),g=m%60;w.push(`${String(v).padStart(2,"0")}:${String(g).padStart(2,"0")}`)}const I=j.timeZone||"Europe/Bucharest",A=new Date().toLocaleString("en-US",{timeZone:I}),M=new Date(A);if(n&&h(n,"yyyy-MM-dd")===h(M,"yyyy-MM-dd")){const m=M.getHours()*60+M.getMinutes(),v=w.filter(g=>{const[D,T]=g.split(":").map(Number);return D*60+T>=m});y(v)}else y(w)}})()},[n,a]),l.useEffect(()=>{d&&_.length>0&&!_.includes(d)&&G("")},[_,d]);const X=t=>{b(o=>o.includes(t)?o.filter(p=>p!==t):[...o,t])},F=()=>S.filter(t=>a.includes(t.id)).reduce((t,o)=>t+o.price,0),q=()=>S.filter(t=>a.includes(t.id)).reduce((t,o)=>t+o.duration,0),ee=async t=>{if(t.preventDefault(),!(!n||!d||a.length===0)){E(!0);try{await P.post("/appointments",{...i,appointmentDate:h(n,"yyyy-MM-dd"),appointmentTime:d,services:a,totalPrice:F()});const o=new URLSearchParams({date:h(n,"yyyy-MM-dd"),time:d,name:i.fullName,duration:String(q())});r(`/success?${o.toString()}`)}catch(o){if(console.error("Booking failed",o),o.response?.status===429&&o.response?.data?.code==="BOOKING_RATE_LIMIT"){const p=o.response.data.retryAfterSeconds,C=Math.ceil(p/60);alert(s("booking.alert_rate_limit",{minutes:C}))}else alert(s("booking.alert_error"))}finally{E(!1)}}};return e.jsxs("div",{className:"bg-dark-800 rounded-2xl p-6 md:p-8 shadow-xl border border-white/10",children:[e.jsxs("div",{className:"flex justify-between mb-8 relative",children:[e.jsx("div",{className:"absolute top-1/2 left-0 w-full h-0.5 bg-dark-700 -z-10"}),[1,2,3].map(t=>e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold transition-colors ${c>=t?"bg-gold-500 text-dark-900":"bg-dark-700 text-gray-400"}`,children:c>t?e.jsx(ce,{className:"h-6 w-6"}):t},t))]}),e.jsxs("form",{onSubmit:ee,children:[c===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:s("booking.step_1_title")}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:S.map(t=>e.jsx(ne,{...t,selected:a.includes(t.id),onSelect:()=>X(t.id)},t.id))}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-white/10",children:[e.jsxs("div",{className:"text-white",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Total estimat:"}),e.jsxs("p",{className:"text-2xl font-bold text-gold-500",children:[F()," RON"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[q()," min"]})]}),e.jsxs("button",{type:"button",disabled:a.length===0,onClick:()=>u(2),className:"bg-gold-500 text-dark-900 px-6 py-3 rounded-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gold-400 transition-colors flex items-center gap-2",children:[s("booking.next")," ",e.jsx(W,{className:"h-4 w-4"})]})]})]}),c===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:s("booking.step_2_title")}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("div",{className:"bg-dark-900 p-4 rounded-xl border border-white/10",children:e.jsx(de,{mode:"single",selected:n,onSelect:Q,locale:x,disabled:[{before:new Date},{after:new Date(new Date().setDate(new Date().getDate()+j.maxBookingDays))}],modifiersClassNames:{selected:"bg-gold-500 text-dark-900 font-bold hover:bg-gold-400",today:"text-gold-500 font-bold"},className:"text-white mx-auto"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-bold mb-4",children:s("booking.avail_hours")}),n?_.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"Salonul este Ã®nchis Ã®n aceastÄƒ zi"}):e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2",children:_.map(t=>e.jsx("button",{type:"button",onClick:()=>G(t),className:`p-2 rounded-lg text-sm font-medium transition-colors ${d===t?"bg-gold-500 text-dark-900":"bg-dark-700 text-gray-300 hover:bg-dark-600"}`,children:t},t))}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:"SelecteazÄƒ o datÄƒ mai Ã®ntÃ¢i"})]})]}),e.jsxs("div",{className:"flex justify-between pt-4 border-t border-white/10",children:[e.jsxs("button",{type:"button",onClick:()=>u(1),className:"text-gray-400 hover:text-white flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"})," ÃŽnapoi"]}),e.jsxs("button",{type:"button",disabled:!n||!d,onClick:()=>u(3),className:"bg-gold-500 text-dark-900 px-6 py-3 rounded-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gold-400 transition-colors flex items-center gap-2",children:["UrmÄƒtorul ",e.jsx(W,{className:"h-4 w-4"})]})]})]}),c===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:s("booking.step_3_title")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:s("booking.label_name")}),e.jsx("input",{type:"text",required:!0,value:i.fullName,onChange:t=>B({...i,fullName:t.target.value}),className:"w-full bg-dark-900 border border-white/10 rounded-lg p-3 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none transition-colors",placeholder:s("booking.placeholder_name")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:s("booking.label_phone")}),e.jsx(he,{value:i.phone,onChange:t=>B({...i,phone:t||""}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:s("booking.label_email")}),e.jsx("input",{type:"email",value:i.email,onChange:t=>B({...i,email:t.target.value}),className:"w-full bg-dark-900 border border-white/10 rounded-lg p-3 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none transition-colors",placeholder:s("booking.placeholder_email")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:s("booking.label_message")}),e.jsx("textarea",{value:i.message,onChange:t=>B({...i,message:t.target.value}),className:"w-full bg-dark-900 border border-white/10 rounded-lg p-3 text-white focus:border-gold-500 focus:ring-1 focus:ring-gold-500 outline-none transition-colors h-24 resize-none",placeholder:s("booking.placeholder_message")})]})]}),e.jsxs("div",{className:"bg-dark-900 p-4 rounded-lg border border-white/10 space-y-2",children:[e.jsx("h3",{className:"font-bold text-white",children:s("booking.summary_title")}),e.jsxs("p",{className:"text-gray-400 text-sm flex justify-between",children:[e.jsx("span",{children:s("booking.summary_services")}),e.jsx("span",{className:"text-white",children:s("booking.selected_count",{count:a.length})})]}),e.jsxs("p",{className:"text-gray-400 text-sm flex justify-between",children:[e.jsx("span",{children:s("booking.summary_date")}),e.jsx("span",{className:"text-white",children:n?h(n,"dd MMMM yyyy",{locale:x}):"-"})]}),e.jsxs("p",{className:"text-gray-400 text-sm flex justify-between",children:[e.jsx("span",{children:s("booking.summary_time")}),e.jsx("span",{className:"text-white",children:d||"-"})]}),e.jsxs("div",{className:"pt-2 border-t border-white/10 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:s("booking.summary_total")}),e.jsxs("span",{className:"text-xl font-bold text-gold-500",children:[F()," RON"]})]})]}),e.jsxs("div",{className:"flex justify-between pt-4 border-t border-white/10",children:[e.jsxs("button",{type:"button",onClick:()=>u(2),className:"text-gray-400 hover:text-white flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"})," ",s("booking.back")]}),e.jsx("button",{type:"submit",disabled:f,className:"bg-gold-500 text-dark-900 px-8 py-3 rounded-lg font-bold disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gold-400 transition-colors flex items-center gap-2",children:f?e.jsx(me,{className:"h-5 w-5 animate-spin"}):s("booking.confirm_btn")})]})]})]})]})},we=()=>{const{t:r}=J("common");return e.jsxs("div",{className:"min-h-screen bg-dark-900 py-12 px-4 sm:px-6 lg:px-8",children:[e.jsx(ge,{title:r("booking.seo_title"),description:r("booking.seo_desc"),canonical:"https://kingsbarber.ro/booking"}),e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:r("booking.title")}),e.jsx("p",{className:"text-gray-400",children:r("booking.subtitle")})]}),e.jsx(ue,{})]})]})};export{we as default};
